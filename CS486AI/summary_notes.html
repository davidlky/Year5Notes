<!doctype html><html><head><meta charset="utf-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js">
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
<link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/texmath.css">
<link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/vscode-texmath.css">

</head><body class="markdown-body">
<h1 id="l01-17" data-line="0" class="code-line">L01, 1/7</h1>
<p data-line="2" class="code-line">What is AI?</p>
<ul>
<li data-line="4" class="code-line">The synthesis and analysis of computational agents that act intelligently.</li>
</ul>
<p data-line="6" class="code-line">An agent acts intelligently when</p>
<ul>
<li data-line="8" class="code-line">what it does is appropriate for its circumstances and its goals, taking into account the short-term and long-term consequences of its actions</li>
<li data-line="9" class="code-line">it is flexible to changing environments and changing goals</li>
<li data-line="10" class="code-line">it learns from experience</li>
<li data-line="11" class="code-line">it makes appropriate choices given its perceptual and computational limitations</li>
</ul>
<h1 id="l02-19" data-line="13" class="code-line">L02, 1/9</h1>
<p data-line="15" class="code-line">Studies of AI</p>
<ul>
<li data-line="17" class="code-line">Mimic Life: build artificial versions of things
<ul>
<li data-line="18" class="code-line">heart, animals, etc.</li>
</ul>
</li>
<li data-line="19" class="code-line">understand principles and make machines that embodies them</li>
</ul>
<p data-line="21" class="code-line">Low Road vs High Road</p>
<p data-line="23" class="code-line">Cognitive vs Affective Thinking</p>
<p data-line="25" class="code-line">Traditional AI</p>
<ul>
<li data-line="27" class="code-line">Environment -&gt; perception -&gt; cognition (-&gt; emotion) -&gt; action -&gt; environment</li>
</ul>
<p data-line="29" class="code-line">Socio-Cultural View</p>
<ul>
<li data-line="31" class="code-line">Environment -&gt; perception -&gt; affect (-&gt; cognition) -&gt; action -&gt; environment</li>
</ul>
<p data-line="33" class="code-line">Emotions: New AI</p>
<ul>
<li data-line="35" class="code-line">AI -&gt; Intelligence = rationality</li>
<li data-line="36" class="code-line">emotions are needed for intelligence</li>
<li data-line="37" class="code-line">low road offers <em>heuristic</em> social intelligence
<ul>
<li data-line="38" class="code-line">provide a social order</li>
</ul>
</li>
</ul>
<h2 id="l03-lecture-2-112" data-line="40" class="code-line">L03 (Lecture 2), 1/12</h2>
<p data-line="42" class="code-line">Agent perform actions to affect the enviornment</p>
<ul>
<li data-line="44" class="code-line">makes decisions based on abilities, goals/prefernces, prior knowledge, stimuli and past experiences</li>
</ul>
<p data-line="46" class="code-line">Knowledge Representation - Symbol Systems</p>
<ul>
<li data-line="48" class="code-line">Symbol is a meaningful physical pattern that can be manipulated</li>
<li data-line="49" class="code-line">Symbol system: create, copies, modifies and destroys symbols</li>
<li data-line="50" class="code-line">Physical Symbol System Hypothesis:
<ul>
<li data-line="51" class="code-line">a PSS has the necessary and sufficient means for general intelligent action
<ul>
<li data-line="52" class="code-line">AI on computer is possible in theory, but not feasible in practice</li>
</ul>
</li>
</ul>
</li>
</ul>
<p data-line="54" class="code-line">Good representation:</p>
<ul>
<li data-line="56" class="code-line">Expressive, close to problem (compact and maintainable), amenable to efficient computation, amenable from more input</li>
</ul>
<p data-line="58" class="code-line">Decision making for AI</p>
<ul>
<li data-line="60" class="code-line">Abilities: what can it do</li>
<li data-line="61" class="code-line">Observations: direct input from environment</li>
<li data-line="62" class="code-line">Prior Knowledge: knowledge base when developed (map, capabilities)</li>
<li data-line="63" class="code-line">Past Experiences</li>
<li data-line="64" class="code-line">Goals</li>
</ul>
<p data-line="66" class="code-line">Dimensions</p>
<ul>
<li data-line="68" class="code-line">Research leads to simplifying assumptions and reducing them
<ul>
<li data-line="69" class="code-line">each simplification leads gives a new <em>dimension</em>
<ul>
<li data-line="70" class="code-line">can be multiple values - simple to complex values</li>
<li data-line="71" class="code-line">combine these assumptions</li>
</ul>
</li>
</ul>
</li>
</ul>
<p data-line="73" class="code-line">Much of AI is to find compact representations and exploiting it for computational gains</p>
<p data-line="75" class="code-line">Agent reason in terms of</p>
<ul>
<li data-line="77" class="code-line">explicit states</li>
<li data-line="78" class="code-line">features/propositions</li>
<li data-line="79" class="code-line">individuals + relations
<ul>
<li data-line="80" class="code-line">feature for each relationship on tuples of individuals</li>
</ul>
</li>
</ul>
<p data-line="82" class="code-line">Planning Horizon</p>
<ul>
<li data-line="84" class="code-line">how far Agent looks into future when deciding
<ul>
<li data-line="85" class="code-line">static: world does not change</li>
<li data-line="86" class="code-line">finite stage: fixed number of time steps</li>
<li data-line="87" class="code-line">indefinite stage: finite but not predetermined #</li>
<li data-line="88" class="code-line">infinite: plan for going forever</li>
</ul>
</li>
</ul>
<p data-line="90" class="code-line">Uncertainty</p>
<ul>
<li data-line="92" class="code-line">what agent can determine the state from observations
<ul>
<li data-line="93" class="code-line">Fully observable: know the state of world from observation</li>
<li data-line="94" class="code-line">Partially Observable: there's many states that are possible from observation</li>
</ul>
</li>
</ul>
<p data-line="96" class="code-line">Uncertain Dynamics</p>
<ul>
<li data-line="98" class="code-line">if the agent knew initial state and action, can it predict the ending state?
<ul>
<li data-line="99" class="code-line">deterministic: can be determined from action and state</li>
<li data-line="100" class="code-line"><strong>stochastic</strong>: uncertainty over states resulting from action from state</li>
</ul>
</li>
</ul>
<p data-line="102" class="code-line">Goals or complex preferences</p>
<ul>
<li data-line="104" class="code-line">achievement goals: goal to be reached</li>
<li data-line="105" class="code-line">maintenance goal</li>
<li data-line="106" class="code-line">complex preferences: tradeoff between decisions</li>
</ul>
<p data-line="108" class="code-line">Single agent: reasoning is where agent assume other agents are part of the environment</p>
<p data-line="110" class="code-line">Multiple agent: agent needs to reason about the reasoning of other agents</p>
<p data-line="112" class="code-line">Knowledge can be given or learned from data or past experience</p>
<p data-line="114" class="code-line">Perfect rationality: agent can determine best course of action, net of limited computational power</p>
<p data-line="116" class="code-line">Bounded rationality: makes good decisions based on limitations</p>
<h2 id="l04-113-states-and-searching" data-line="118" class="code-line">L04, 1/13, States and Searching</h2>
<ul>
<li data-line="120" class="code-line">A graph consists of a set N of nodes and a set A of ordered pairs of nodes, called arcs .</li>
</ul>
<p data-line="122" class="code-line">Maintain a <strong>frontier</strong> of paths that have been explored</p>
<p data-line="124" class="code-line">Search strategy determines how the frontier expands</p>
<p data-line="126" class="code-line">Types of search</p>
<ol>
<li data-line="128" class="code-line">Uninformed (Blind)</li>
<li data-line="129" class="code-line">Heuristic</li>
<li data-line="130" class="code-line">More sophisticated &quot;hacks&quot;</li>
</ol>
<p data-line="132" class="code-line">DFS - not guaranteed to end for infinite graph and cycles</p>
<ul>
<li data-line="134" class="code-line">add extra cycle check</li>
<li data-line="135" class="code-line">linear in space complexity</li>
</ul>
<p data-line="137" class="code-line">BFS - queue format</p>
<ul>
<li data-line="139" class="code-line">needs to be aware of <strong>branching factor</strong>
<ul>
<li data-line="140" class="code-line">if guaranteed to be finite, then will for sure find solution</li>
</ul>
</li>
<li data-line="141" class="code-line">time complexity is exponential on BF -&gt; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><msup><mi>f</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">bf^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">b</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>, n being length</li>
<li data-line="142" class="code-line">space complexity as well</li>
</ul>
<p data-line="144" class="code-line">Lowest Cost first search</p>
<ul>
<li data-line="146" class="code-line">cost of path is the sum of all costs for each arc</li>
<li data-line="147" class="code-line">greedy: choose lowest cost first at each stage
<ul>
<li data-line="148" class="code-line">keep in priority queue, when tied, BFS</li>
</ul>
</li>
</ul>
<h3 id="heuristic-search" data-line="150" class="code-line">Heuristic Search</h3>
<ul>
<li data-line="152" class="code-line">don't ignore goals when searching
<ul>
<li data-line="153" class="code-line">use extra knowledge - <strong>heuristic</strong></li>
</ul>
</li>
<li data-line="154" class="code-line">takes into account of h(n) -&gt; estimated cost
<ul>
<li data-line="155" class="code-line">make sure always underestimate</li>
</ul>
</li>
<li data-line="156" class="code-line">eg. Manhattan distance, speed, straight line</li>
</ul>
<p data-line="158" class="code-line">Greedy best first search, only care about h, not optimal</p>
<p data-line="160" class="code-line">Heuristic DFS - add to stack according to <code>h</code></p>
<ul>
<li data-line="162" class="code-line">locally does a best first search, same problems as DFS</li>
</ul>
<p data-line="164" class="code-line">A* search</p>
<ul>
<li data-line="166" class="code-line">use both path cost and <code>h</code></li>
<li data-line="167" class="code-line"><code>f(p) = h(p) + c(p)</code></li>
<li data-line="168" class="code-line">mix of both lowest cost first and best first</li>
<li data-line="169" class="code-line">always choose the lowest by <code>f(p)</code> in priority queue</li>
<li data-line="170" class="code-line">A* usually finds the best solution
<ul>
<li data-line="171" class="code-line">when BF is finite, all arcs are none-0, <code>h</code> underestimate the costs</li>
</ul>
</li>
<li data-line="172" class="code-line"><strong>Admissible H(n) never overestimate the costs</strong></li>
</ul>
<h3 id="constructing-a-heuristic" data-line="174" class="code-line">Constructing a Heuristic</h3>
<ul>
<li data-line="176" class="code-line">Relax the game, make it easier</li>
<li data-line="177" class="code-line">find which heuristic works best in each simplification</li>
</ul>
<table>
<thead>
<tr>
<th>Strategy</th>
<th>Frontier Selection</th>
<th>Halts?</th>
<th>Space</th>
<th>Time</th>
</tr>
</thead>
<tbody>
<tr>
<td>Depth-first</td>
<td>Last node added</td>
<td>No</td>
<td>Linear</td>
<td>Exp</td>
</tr>
<tr>
<td>Breadth-first</td>
<td>First node added</td>
<td>Yes</td>
<td>Exp</td>
<td>Exp</td>
</tr>
<tr>
<td>Heuristic depth-first</td>
<td>Local1 min h(n)</td>
<td>No</td>
<td>Linear</td>
<td>Exp</td>
</tr>
<tr>
<td>Best-first</td>
<td>Global2 min h(n)</td>
<td>No</td>
<td>Exp</td>
<td>Exp</td>
</tr>
<tr>
<td>Lowest-cost-first</td>
<td>Minimal cost(n)</td>
<td>Yes</td>
<td>Exp</td>
<td>Exp</td>
</tr>
<tr>
<td>A ∗</td>
<td>Minimal f(n)</td>
<td>Yes</td>
<td>Exp</td>
<td>Exp</td>
</tr>
</tbody>
</table>
<p data-line="188" class="code-line">Path Pruning</p>
<ul>
<li data-line="190" class="code-line">for DFS -&gt; constant time as you can add flags</li>
<li data-line="191" class="code-line">other cases, linear time in length of the path</li>
</ul>
<p data-line="193" class="code-line">Multiple Path Pruning</p>
<ul>
<li data-line="195" class="code-line">prune a path to <code>n</code> that a path to has already been found for</li>
<li data-line="196" class="code-line">store all node already discovered path to</li>
</ul>
<p data-line="198" class="code-line">Problem: what if we end up discovering a path that is shorter for n?</p>
<ul>
<li data-line="200" class="code-line">go back and fix every path's prefix</li>
<li data-line="201" class="code-line">remove the old paths</li>
<li data-line="202" class="code-line">ensure this does not happen: shortest path first (lowest-cost-first search)</li>
</ul>
<p data-line="204" class="code-line">Monotonic Restriction</p>
<ul>
<li data-line="206" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mi>m</mi><mo>)</mo><mi mathvariant="normal">−</mi><mi>h</mi><mo>(</mo><mi>n</mi><mo>)</mo><mo>≤</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">h(m) − h(n) ≤ cost(m, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mord">−</span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> for every arch</li>
<li data-line="207" class="code-line">make sure heuristic estimate is always less than actual cost</li>
<li data-line="208" class="code-line">If h satisfies the monotone restriction, A ∗ with multiple path pruning always finds the shortest path to a goal.</li>
<li data-line="209" class="code-line">basically, <em>admissible</em> between any 2 nodes!</li>
</ul>
<p data-line="211" class="code-line">Iterative Deepening</p>
<ul>
<li data-line="213" class="code-line">all halting algo requires exp space</li>
<li data-line="214" class="code-line">what if recompute the frontier instead of saving them</li>
<li data-line="215" class="code-line">depth-bounded DFS</li>
</ul>
<p data-line="217" class="code-line">Note: searching is symmetrical, if forward does not work, then check backwards (BF for forward vs backward: in vs out)</p>
<p data-line="219" class="code-line">Bidirectional: use both sides</p>
<ul>
<li data-line="221" class="code-line">use BFS to try to get to the middle, and see if the other side can meet the frontier</li>
<li data-line="222" class="code-line">save exponentially in time and space</li>
</ul>
<p data-line="224" class="code-line">Island driven search</p>
<ul>
<li data-line="226" class="code-line">
<p data-line="226" class="code-line">find all the path in between and make it into <code>m</code> subproblems</p>
<ul>
<li data-line="228" class="code-line">hard to say which path are correct and which are good island</li>
</ul>
</li>
<li data-line="230" class="code-line">
<p data-line="230" class="code-line">DP: work backwards find the cost and store it for each node</p>
</li>
<li data-line="231" class="code-line">
<h2 id="l04-119-constraint-satisfaction-problems" data-line="231" class="code-line">L04, 1/19 Constraint Satisfaction Problems</h2>
</li>
</ul>
<p data-line="233" class="code-line">Constraint Satisfaction Problems</p>
<ul>
<li data-line="235" class="code-line">set of variables, domain for each variable</li>
<li data-line="236" class="code-line">set of constraints or evaluation function</li>
</ul>
<p data-line="238" class="code-line">2 types</p>
<ul>
<li data-line="240" class="code-line">Satisfiability Problems: find assignment that satisfy constraints (hard)</li>
<li data-line="241" class="code-line">Optimization Problems: find assignment that optimizes (soft)</li>
</ul>
<p data-line="243" class="code-line">Solution: assignment that satisfy all constraints</p>
<ul>
<li data-line="245" class="code-line">a <strong>model</strong> of constraints</li>
</ul>
<p data-line="247" class="code-line">CSP as Graph Problems</p>
<ul>
<li data-line="249" class="code-line">2 ways:</li>
<li data-line="250" class="code-line">Complete:
<ul>
<li data-line="251" class="code-line">nodes: assignment of values</li>
<li data-line="252" class="code-line">neighbors: change of one variable</li>
</ul>
</li>
<li data-line="253" class="code-line">Partial:
<ul>
<li data-line="254" class="code-line">node: assignment to first k-1 variable</li>
<li data-line="255" class="code-line">neighbors: assignment to k-th variable</li>
</ul>
</li>
</ul>
<p data-line="257" class="code-line">Problem: no clear start, large trees, path can be ignored so not needed!</p>
<p data-line="259" class="code-line">Constraints</p>
<ul>
<li data-line="261" class="code-line">can be N-ary: over sets of N variables</li>
<li data-line="262" class="code-line">here: consider only unary and binary (crossword where words are the domain)</li>
</ul>
<p data-line="264" class="code-line">Ways:</p>
<ul>
<li data-line="266" class="code-line">Generate and Test</li>
<li data-line="267" class="code-line">Backtracking</li>
<li data-line="268" class="code-line">Consistency</li>
<li data-line="269" class="code-line">Hill-Climbing</li>
<li data-line="270" class="code-line">Randomized Local Search</li>
</ul>
<p data-line="272" class="code-line">For simple cases with clear logic maps, we can do generate and test</p>
<h3 id="backtracking" data-line="274" class="code-line">Backtracking</h3>
<ul>
<li data-line="276" class="code-line">if we know large part of state space cna be pruned, then we can optimize
<ul>
<li data-line="277" class="code-line">order the variables</li>
<li data-line="278" class="code-line">evaluate without full assignment
<ul>
<li data-line="279" class="code-line">see if something is already failing</li>
</ul>
</li>
</ul>
</li>
</ul>
<p data-line="281" class="code-line">We keep trying at each instance, when something is exhausted, then we backtrack to another variable</p>
<p data-line="283" class="code-line">Efficiency depends on order of variable!</p>
<ul>
<li data-line="285" class="code-line">optimal ordering of variable is as hard as solving problem though!</li>
<li data-line="286" class="code-line">Idea: fail fast!!
<ul>
<li data-line="287" class="code-line">put as little variable as possible to check first, then build up!</li>
</ul>
</li>
</ul>
<h3 id="consistency" data-line="289" class="code-line">Consistency</h3>
<ul>
<li data-line="291" class="code-line">
<p data-line="291" class="code-line">More general approach, look for inconsistency</p>
</li>
<li data-line="292" class="code-line">
<p data-line="292" class="code-line">ie. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mi>f</mi><mi>E</mi><mo>≤</mo><mi>A</mi><mo separator="true">,</mo><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mi>A</mi><mo>∈</mo><mo>{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo>}</mo></mrow><annotation encoding="application/x-tex">if E \le A, where A \in \{1,2,3,4\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mclose">}</span></span></span></span> then <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi mathvariant="normal">≠</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">E \neq 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel latin_fallback"≯</span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span></p>
<ul>
<li data-line="294" class="code-line">not wait for discovery of earlier variables</li>
</ul>
</li>
<li data-line="296" class="code-line">
<p data-line="296" class="code-line">Graphical approach instead of tree based</p>
</li>
<li data-line="298" class="code-line">
<p data-line="298" class="code-line">Build a <strong>constraint network</strong> (CN)!</p>
</li>
<li data-line="299" class="code-line">
<p data-line="299" class="code-line">domain constraint -&gt; unary constraint on domain <code>&lt;X, C(X)&gt;</code></p>
</li>
<li data-line="300" class="code-line">
<p data-line="300" class="code-line">node in CN is domain consistent if no domain value value violates a domain constraint</p>
<ul>
<li data-line="301" class="code-line">CN is domain consistent iff true for all nodes</li>
</ul>
</li>
<li data-line="302" class="code-line">
<p data-line="302" class="code-line">Arc <code>&lt;X, C(X, Y)&gt;</code> is constraint on X</p>
</li>
<li data-line="303" class="code-line">
<p data-line="303" class="code-line">arc is arc consistent if for each <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>∈</mo><msub><mi>D</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">X \in D_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> there is some <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span></eq> so that the constraint is satisfied</p>
<ul>
<li data-line="304" class="code-line">CN is arc consistent iff true for all arcs</li>
</ul>
</li>
<li data-line="305" class="code-line">
<p data-line="305" class="code-line">set of variable <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>X</mi><mi>n</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">\{X_1, X_2, ..., X_n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> is path consistent iff all arc and domain are consistent</p>
</li>
</ul>
<h3 id="ac-3" data-line="307" class="code-line">AC-3</h3>
<p data-line="309" class="code-line">Make a CN <strong>arc consistent (and domain consistent)</strong></p>
<ul>
<li data-line="311" class="code-line">TO-Do Arcs Queue (TDA) has all inconsistent Arcs</li>
<li data-line="312" class="code-line">choose one arc at a time with a constraint
<ul>
<li data-line="313" class="code-line">see if all values in domain of X has value in Y for <code>C(X, Y)</code>, remove from X if needed</li>
<li data-line="314" class="code-line">if any removed from X, add All <code>&lt;Z, C(Z, X)&gt;</code> where Z is not Y or X</li>
</ul>
</li>
</ul>
<p data-line="316" class="code-line">3 ways of termination:</p>
<ul>
<li data-line="318" class="code-line">every domain is empty -&gt; impossible</li>
<li data-line="319" class="code-line">one solution</li>
<li data-line="320" class="code-line">some have more than 1 (split in two run on two halves, only add the <code>&lt;Z, C(Z, X)&gt;</code> on split domain X)</li>
</ul>
<p data-line="322" class="code-line">Variable Elimination</p>
<ul>
<li data-line="324" class="code-line">Idea: eliminate variable 1 by 1 to pass constraints to neighbors</li>
<li data-line="325" class="code-line">if single variable left, no value left: then inconsistent!!</li>
<li data-line="326" class="code-line">we need to find elimination ordering
<ul>
<li data-line="327" class="code-line">different ordering result in different intermediate constraints</li>
</ul>
</li>
</ul>
<p data-line="329" class="code-line">Algo</p>
<ul>
<li data-line="331" class="code-line">if one variable, return intersection of the constraints</li>
<li data-line="332" class="code-line">else, Select variable X
<ul>
<li data-line="333" class="code-line">join all constraints of X, forming R
<ul>
<li data-line="334" class="code-line">enforce R on all variables other than X</li>
</ul>
</li>
<li data-line="335" class="code-line">Replace all constraints where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> appears by a new constraints: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li data-line="336" class="code-line">Combine <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> with all constraints between variables</li>
<li data-line="337" class="code-line">Remove X</li>
<li data-line="338" class="code-line">recurse</li>
<li data-line="339" class="code-line">return R joined!</li>
</ul>
</li>
</ul>
<p data-line="341" class="code-line">start from arc consistent network!</p>
<p data-line="343" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/1.png" alt="image" class="loading" id="image-hash-140dd5577167c398e4fe592034ce0758b6f3337b588490685f4a7c95c3078e0d"></p>
<h3 id="local-search" data-line="345" class="code-line">Local Search</h3>
<ul>
<li data-line="347" class="code-line">assume Local search, where nodes are assignment to a value
<ul>
<li data-line="348" class="code-line">heuristic improvements</li>
</ul>
</li>
<li data-line="349" class="code-line">aim is to find an assignment with 0 unsatisfied constraints
<ul>
<li data-line="350" class="code-line">given assignment, a conflict is an unsatisfied constraint</li>
<li data-line="351" class="code-line">goal is 0 conflicts</li>
<li data-line="352" class="code-line">Heuristic Function to minimize: # of conflicts</li>
</ul>
</li>
</ul>
<p data-line="354" class="code-line">Variants: Greedy Descent</p>
<ul>
<li data-line="356" class="code-line">Find variable-value pair that minimize at every step</li>
<li data-line="357" class="code-line">find variable with most conflict, select value with minimal conflicts</li>
<li data-line="358" class="code-line">select variable in any conflict, value that min conflicts</li>
<li data-line="359" class="code-line">select at random, find value with min conflict</li>
<li data-line="360" class="code-line">select at random, accept if no increase</li>
</ul>
<p data-line="362" class="code-line">GSAT - Greedy</p>
<ul>
<li data-line="364" class="code-line">repeatly find neighbot that minimizes H(N)</li>
<li data-line="365" class="code-line">cant change same variable 2 times in a row though!</li>
</ul>
<p data-line="367" class="code-line">Problem: local minimum is not global minimum!</p>
<ul>
<li data-line="369" class="code-line">during plateaus where h(n) is useless, at ridge, a check can help (look ahead)</li>
</ul>
<p data-line="371" class="code-line">Randomized Greedy Descent</p>
<ul>
<li data-line="373" class="code-line">as well as downward steps, we can randomly move to a neighbor and randomly reassign values to all variables?</li>
</ul>
<p data-line="375" class="code-line">At higher dimensions really hard to visualize and do local search!</p>
<ul>
<li data-line="377" class="code-line">canyons are common!</li>
</ul>
<h3 id="stochastic-local-search" data-line="379" class="code-line">Stochastic Local Search</h3>
<ul>
<li data-line="381" class="code-line">mix of greedy descent, random walk (taking random steps) and random restart</li>
</ul>
<p data-line="383" class="code-line">Variant: simulated Annealing</p>
<ul>
<li data-line="385" class="code-line">
<p data-line="385" class="code-line">pick random variable and random new value</p>
<ul>
<li data-line="387" class="code-line">if improvement, take</li>
<li data-line="388" class="code-line">if not, use <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span></eq> and switch based on probability: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mo>(</mo><mi>h</mi><mo>(</mo><msup><mi>n</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo><mo>−</mo><mi>h</mi><mo>(</mo><mi>n</mi><mo>)</mo><mo>)</mo><mi mathvariant="normal">/</mi><mi>T</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{-(h(n&#x27;) - h(n))/T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.94248em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">h</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">h</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li data-line="390" class="code-line">
<p data-line="390" class="code-line">the higher the temperature the more likely the change (at T = 1, 1 diff is around 37%)</p>
</li>
<li data-line="391" class="code-line">
<p data-line="391" class="code-line">reduce T everytime</p>
</li>
</ul>
<p data-line="393" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/2.png" alt="image" class="loading" id="image-hash-8d8e0dcdc68d40adbf4e2213e702e3748ec8c9d0b1190d1dcb5fcc7541d2fe83"></p>
<p data-line="395" class="code-line">Tabu Lists</p>
<ul>
<li data-line="397" class="code-line">like GSAT: Never choose same variable twice!</li>
<li data-line="398" class="code-line">keep track of last <code>k</code> assignments</li>
</ul>
<p data-line="400" class="code-line">Parallel Search</p>
<ul>
<li data-line="402" class="code-line">total assignment: individual
<ul>
<li data-line="403" class="code-line">IDEA: maintain a population of <code>k</code> individuals instead of one</li>
<li data-line="404" class="code-line">At each stage update the individual in the population</li>
<li data-line="405" class="code-line">basically <code>k</code> times the number of steps and check multiple at the same time</li>
</ul>
</li>
</ul>
<p data-line="407" class="code-line">Beam Search</p>
<ul>
<li data-line="409" class="code-line">choose <code>k</code> best options (like parallel search)</li>
<li data-line="410" class="code-line">when <code>k = 1</code> -&gt; greedy descent</li>
</ul>
<p data-line="412" class="code-line">Stochastic Beam Search</p>
<ul>
<li data-line="414" class="code-line">probabilistically chooses <code>k</code> individuals at next generation</li>
<li data-line="415" class="code-line">probability it is chosen: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>h</mi><mo>(</mo><mi>n</mi><mo>)</mo><mi mathvariant="normal">/</mi><mi>T</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{-h(n)/T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">h</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li data-line="416" class="code-line">maintains diversity betterm heuristic reflect the fitness</li>
<li data-line="417" class="code-line">asexual reproduction</li>
</ul>
<p data-line="419" class="code-line">Genetic Algo</p>
<ul>
<li data-line="421" class="code-line">pairs are combined to create offspring
<ul>
<li data-line="422" class="code-line">randomly chooses pairs of individuals where fittest individuals are more likely</li>
<li data-line="423" class="code-line">perform crossover: form two offspring each taking different part of parents and see what are the fittest</li>
</ul>
</li>
<li data-line="424" class="code-line">depends on the effectiveness of ordering of variable</li>
</ul>
<p data-line="426" class="code-line">Comparing Stochastic Algorithm</p>
<ul>
<li data-line="428" class="code-line">Check summary statistics: mean runtime, median, mode dont work</li>
</ul>
<h2 id="l05-propositional-and-interference" data-line="430" class="code-line">L05, Propositional and Interference</h2>
<p data-line="432" class="code-line">2 ways to solve problems</p>
<ul>
<li data-line="434" class="code-line">Procedural
<ul>
<li data-line="435" class="code-line">device algorithm</li>
<li data-line="436" class="code-line">program</li>
<li data-line="437" class="code-line">execute</li>
</ul>
</li>
<li data-line="438" class="code-line">Declarative
<ul>
<li data-line="439" class="code-line">identify knowledge needed</li>
<li data-line="440" class="code-line">encode knowledge in representation (Knowledge base - KB)</li>
<li data-line="441" class="code-line">use logical consequences to solve</li>
</ul>
</li>
</ul>
<p data-line="443" class="code-line">Procedural</p>
<ul>
<li data-line="445" class="code-line">how to knowledge, programs, meanings of computation</li>
<li data-line="446" class="code-line">C, C++ etc.</li>
</ul>
<p data-line="448" class="code-line">Declarative</p>
<ul>
<li data-line="450" class="code-line">descriptive knowledge</li>
<li data-line="451" class="code-line">meaning of symbol = real world</li>
<li data-line="452" class="code-line">prop logic, relational db</li>
</ul>
<p data-line="454" class="code-line">Proof Procedures</p>
<ul>
<li data-line="456" class="code-line">Logic: syntax(what is acceptable sentence?), semantics (what do symbols mean) and proof procedure (what is valid)</li>
</ul>
<p data-line="458" class="code-line">A proof is a sequence of sentences derivable using inference rules</p>
<p data-line="460" class="code-line">Modus Ponens = Tautology <code>((A → B) ∧ A) → B</code> If it’s raining then the grass is wet it’s raining therefore the grass is wet</p>
<p data-line="462" class="code-line">Modus Tolens is a Tautology <code>((A → B) ∧ ¬B) → ¬A</code> If it’s raining then the grass is wet the grass is not wet therefore it’s not raining</p>
<p data-line="464" class="code-line">Modus Bogus is <strong>not</strong> a Tautology <code>((A → B) ∧ B) → A</code> If it’s raining then the grass is wet the grass is wet therefore its raining (NOT TRUE)</p>
<p data-line="466" class="code-line">Logical Consequences</p>
<ul>
<li data-line="468" class="code-line">{x} -&gt; set of statements</li>
<li data-line="469" class="code-line">a set of assignemnts is interpretation</li>
<li data-line="470" class="code-line">interpretation of {X} makes {X} true =&gt; <strong>MODEL</strong>
<ul>
<li data-line="471" class="code-line">inconsistent if none exists</li>
</ul>
</li>
</ul>
<p data-line="473" class="code-line">statement A is logical consequence of {X} if A is true in every MODEL of X</p>
<p data-line="475" class="code-line">Validity</p>
<ul>
<li data-line="477" class="code-line">Argument is Valid iff conclusion is logical consequence</li>
</ul>
<p data-line="479" class="code-line">if no premises are true, then conclusion dont matter hence statement holds</p>
<h3 id="proofs" data-line="481" class="code-line">Proofs</h3>
<ul>
<li data-line="483" class="code-line">KB -&gt; set of axioms</li>
<li data-line="484" class="code-line">Proof Procedure: way of Proving</li>
<li data-line="485" class="code-line">A proof procedure is a way of Proving Theorems</li>
<li data-line="486" class="code-line">KB |-g means g can be derived from KB using the proof procedure</li>
<li data-line="487" class="code-line">If KB |-g, then g is a Theorem</li>
<li data-line="488" class="code-line">A proof procedure is sound: <code>if KB |-g then KB |=g</code>.</li>
<li data-line="489" class="code-line">A proof procedure is complete: <code>if KB |=g then KB |-g</code>.</li>
</ul>
<p data-line="491" class="code-line">Two types of proof procedures: bottom up and top down</p>
<p data-line="493" class="code-line">Assume closed world:</p>
<ul>
<li data-line="495" class="code-line">agent knows everything, if cannot be proven, it is false</li>
</ul>
<p data-line="497" class="code-line">(Open world then we cannot do shit because agent cannot conclude shit)</p>
<p data-line="499" class="code-line">Bottom Up Proof</p>
<ul>
<li data-line="501" class="code-line">forward chaining - start from facts and use rules to generate all atoms</li>
</ul>
<p data-line="503" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/3.png" alt="image" class="loading" id="image-hash-9c50213e7a9fc3b2d5b7bd0e24d82f8e15a16557873d92202b602bb685247d4a"></p>
<p data-line="505" class="code-line">Top Down Proof</p>
<ul>
<li data-line="507" class="code-line">start from query and work backwards</li>
</ul>
<p data-line="509" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/4.png" alt="image" class="loading" id="image-hash-a8fa390a978516d47a3b811d7e78538b729bac4a2f70206c717ee2ab6ee1b710"></p>
<p data-line="511" class="code-line">select: “don’t care nondeterminism” (If one doesn’t give a solution, no point trying others!) choose: “don’t know nondeterminism” (if one doesn’t give a solution, others may)</p>
<p data-line="513" class="code-line">Automated Methods</p>
<ul>
<li data-line="515" class="code-line">make everything into CNF (Conjunctive Normal Forms)</li>
<li data-line="516" class="code-line">conjunction of disjunction of atoms
<ul>
<li data-line="517" class="code-line">ands of ors</li>
</ul>
</li>
</ul>
<p data-line="519" class="code-line">Try to show a contradiction with</p>
<ul>
<li data-line="521" class="code-line">modus ponens</li>
<li data-line="522" class="code-line">anything with logical consequence (-&gt;)</li>
</ul>
<p data-line="524" class="code-line">Resolution:</p>
<ul>
<li data-line="526" class="code-line">{A, B}, {C, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">¬</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">\neg B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">¬</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>} =&gt; {A, B}, {C, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">¬</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">\neg B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">¬</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>}, {A, C}</li>
<li data-line="527" class="code-line">Resolution Refutation
<ul>
<li data-line="528" class="code-line">deny conclusion and show resolution becomes contradiction</li>
<li data-line="529" class="code-line">use resolution to add clauses, the all are true, then the refutation of conclusion must be false
<ul>
<li data-line="530" class="code-line">so must be valid</li>
</ul>
</li>
</ul>
</li>
</ul>
<p data-line="532" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/5.png" alt="image" class="loading" id="image-hash-4c53b9926cd1ef4b4fd2788d238678faaab3628507c4747d71c13fe2740f1daa"></p>
<p data-line="534" class="code-line">Constraint Satisfiability can become CNF</p>
<ul>
<li data-line="536" class="code-line">variable Y with domain {<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">v_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>...<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>} becomes k variables {<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>...<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">Y_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>} where it is true if it has value <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li data-line="537" class="code-line">thus, <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></eq> atoms are used to represent CSP## L06, 1/30 Planning under certainty</li>
</ul>
<p data-line="539" class="code-line">MIU puzzle -&gt; not possible</p>
<ul>
<li data-line="541" class="code-line">Planning is finding sequence of actions to solve goals</li>
<li data-line="542" class="code-line">partial function: ???</li>
<li data-line="543" class="code-line">preconditions: specify when action can be carried out</li>
</ul>
<p data-line="545" class="code-line">State performs Action -&gt; resulting state</p>
<p data-line="547" class="code-line">Features: variables Actions</p>
<p data-line="549" class="code-line">Feature Based representation of actions:</p>
<ul>
<li data-line="551" class="code-line">For each action, <strong>precondition</strong> specifies when action can be carried out</li>
<li data-line="552" class="code-line">For each feature:
<ul>
<li data-line="553" class="code-line">causal rules: specifies when feature get new value</li>
<li data-line="554" class="code-line">frame rules: specifies when feature keeps its value</li>
</ul>
</li>
<li data-line="555" class="code-line">X -&gt; X', actions are lower case</li>
</ul>
<p data-line="557" class="code-line">STRIPS</p>
<ul>
<li data-line="559" class="code-line">action centric: specifies effects and preconditions for each action
<ul>
<li data-line="560" class="code-line">precondition -&gt; when should it be carried out</li>
<li data-line="561" class="code-line">effect: set of assignments of values to features that are made true</li>
</ul>
</li>
</ul>
<h3 id="planning" data-line="563" class="code-line">Planning</h3>
<p data-line="565" class="code-line">Given: description of effects and precondition, initial states, goals: find sequence of actions</p>
<p data-line="567" class="code-line">Idea: search in state-space graph</p>
<p data-line="569" class="code-line">Regression Planning</p>
<ul>
<li data-line="571" class="code-line">search backwards from goal: nodes are subgoals and arcs to actions</li>
</ul>
<p data-line="573" class="code-line">Improving Efficiencies</p>
<ul>
<li data-line="575" class="code-line">define a heuristic function that estimates how hard it is to solve the goal from initial state</li>
</ul>
<p data-line="577" class="code-line">compare forward and regression planners</p>
<ul>
<li data-line="579" class="code-line">depend on branching factor and heuristics</li>
</ul>
<p data-line="581" class="code-line">Planning as CSP</p>
<ul>
<li data-line="583" class="code-line">search over horizons (frontier)</li>
<li data-line="584" class="code-line">for each horizon: create a CSP constaining possible actions and features</li>
</ul>
<h3 id="constraints-types" data-line="586" class="code-line">Constraints Types</h3>
<ul>
<li data-line="588" class="code-line">state: between variable at the same time step</li>
<li data-line="589" class="code-line">precondition: between state and action variable that specifies what is available</li>
<li data-line="590" class="code-line">effect: state and action at <code>t</code>, and state variable at <code>t+1</code></li>
<li data-line="591" class="code-line">frame: effect constraints that says variable does not change</li>
<li data-line="592" class="code-line">initial state: domain constraints on initial state</li>
<li data-line="593" class="code-line">goal: constraints final state# 1/30, Supervised Learning</li>
</ul>
<p data-line="595" class="code-line">Learning</p>
<ul>
<li data-line="597" class="code-line">Improve behavior based on experience</li>
<li data-line="598" class="code-line">improve accuracy/range of actions or speed</li>
</ul>
<p data-line="600" class="code-line">Any Learning Problem: task, data, measure of improvement</p>
<p data-line="602" class="code-line">Representation</p>
<ul>
<li data-line="604" class="code-line">Deduction -&gt; Draw from knowledge (top down)</li>
<li data-line="605" class="code-line">Induction -&gt; Infer representation from data (bottom up)</li>
</ul>
<h2 id="common-learning-tasks" data-line="607" class="code-line">Common Learning Tasks</h2>
<p data-line="609" class="code-line">Supervise Learning -&gt; given pre-classified training example, classify new ones</p>
<p data-line="611" class="code-line">Unsupervised Learning -&gt; Find natural classes for examples</p>
<p data-line="613" class="code-line">Reinforcement learning - learning is delayed because of reward system at times</p>
<p data-line="615" class="code-line">Transfer/Active/Inductive Language</p>
<ul>
<li data-line="617" class="code-line">
<p data-line="617" class="code-line">Learning Tasks are characterized by feedback given to learner</p>
</li>
<li data-line="619" class="code-line">
<p data-line="619" class="code-line">Measure of success on new data, not training examples</p>
</li>
<li data-line="620" class="code-line">
<p data-line="620" class="code-line">Biases - tendency to prefer on hypothesis over another</p>
<ul>
<li data-line="621" class="code-line">needed to make predictions on unseen data</li>
<li data-line="622" class="code-line">deciding on a bias is hard</li>
</ul>
</li>
</ul>
<p data-line="624" class="code-line">Given a representation and bias -&gt; problem of learning is basically search.</p>
<p data-line="626" class="code-line">Learrning -&gt; Search through space of possible representations for best representation(s) that fit the data (using bias)</p>
<ul>
<li data-line="628" class="code-line">Search spaces are too large for systematic search</li>
</ul>
<h3 id="learning-algorithm" data-line="630" class="code-line">Learning Algorithm</h3>
<ul>
<li data-line="632" class="code-line">search space, evaluation function and search method</li>
</ul>
<p data-line="634" class="code-line">Data is not perfect:</p>
<ul>
<li data-line="636" class="code-line">Some features are assigned wrong value</li>
<li data-line="637" class="code-line">Incomplete feature set for classification</li>
<li data-line="638" class="code-line">Missing features</li>
</ul>
<p data-line="640" class="code-line">Overfitting: distinction appears in data but not in unseen examples</p>
<ul>
<li data-line="642" class="code-line">caused by random correlations</li>
</ul>
<h3 id="supervised-learning" data-line="644" class="code-line">Supervised Learning</h3>
<ul>
<li data-line="646" class="code-line">
<p data-line="646" class="code-line">Given:</p>
<ul>
<li data-line="648" class="code-line">Input Features <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>X</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">X_1, ..., X_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li data-line="649" class="code-line">Target Features <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>Y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">Y_1, ..., Y_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li data-line="650" class="code-line">Set of training examples -&gt; values for input feature and target features are given</li>
<li data-line="651" class="code-line">Test Example -&gt; where only input features are given</li>
</ul>
</li>
<li data-line="653" class="code-line">
<p data-line="653" class="code-line">Predict value for target feature for the test examples</p>
<ul>
<li data-line="654" class="code-line">Classification: discrete <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span></eq> values</li>
<li data-line="655" class="code-line">Regression: continuous <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span></eq> values</li>
</ul>
</li>
</ul>
<h3 id="evaluating-predictions" data-line="657" class="code-line">Evaluating Predictions</h3>
<ul>
<li data-line="659" class="code-line"><eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span></eq> is a feature, <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span></eq> is an example</li>
<li data-line="660" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Y(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> is the real value</li>
<li data-line="661" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Y</mi><mo>^</mo></mover><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat{Y}(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> is the predicted value</li>
<li data-line="662" class="code-line">Error -&gt; how close the values are</li>
</ul>
<h4 id="measuring-errors" data-line="664" class="code-line">Measuring Errors</h4>
<ul>
<li data-line="666" class="code-line">Absolute Error -&gt; Sum of all absolute differences <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi>Y</mi><mo>−</mo><mover accent="true"><mi>Y</mi><mo>^</mo></mover><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|Y-\hat{Y}|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="mord">∣</span></span></span></span></li>
<li data-line="667" class="code-line">Sum of Squares Error -&gt; Sum of all differences squared <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mo>(</mo><mi>Y</mi><mo>−</mo><mover accent="true"><mi>Y</mi><mo>^</mo></mover><mo>)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{(Y-\hat{Y})}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4007779999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1507779999999999em;"><span style="top:-3.39967em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></li>
<li data-line="668" class="code-line">Worst case Error (Max Abs diff)</li>
</ul>
<p data-line="670" class="code-line">Cost Based Error -&gt; take into account of various errors</p>
<p data-line="672" class="code-line">Likelihood of the data and &quot;entropy&quot; (negative log likelihood)</p>
<p data-line="674" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/6.png" alt="image" class="loading" id="image-hash-935a07657c1aa2cb57c5e49fbed52a847bb44a05aebc8d138a7f41e336fa5db3"></p>
<h3 id="basic-models-for-supervised-learning" data-line="676" class="code-line">Basic Models for Supervised Learning</h3>
<p data-line="678" class="code-line">Many learning algo are derived from decision trees, linear classifiers and Bayesian classifiers</p>
<p data-line="680" class="code-line">Learning Decision Trees</p>
<ul>
<li data-line="682" class="code-line">
<p data-line="682" class="code-line">Represented by a decision tree -&gt; Bias towards simple decision tree!</p>
</li>
<li data-line="683" class="code-line">
<p data-line="683" class="code-line">Search through space of decision trees, from simple to more complex ones</p>
</li>
<li data-line="685" class="code-line">
<p data-line="685" class="code-line">Simple, successful technique for supervised learning from discrete data</p>
<ul>
<li data-line="686" class="code-line">Nodes are input attributes/features</li>
<li data-line="687" class="code-line">Branches are labeled with input feature values</li>
<li data-line="688" class="code-line">Leaves are predictions for &quot;Target&quot; features</li>
<li data-line="689" class="code-line">Can have many branch per node</li>
<li data-line="690" class="code-line">Branches can have many feature values</li>
</ul>
</li>
</ul>
<p data-line="692" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/7.png" alt="image" class="loading" id="image-hash-65d7363e7ed61c1872d780af20978746163673624c69cfa48c407658b72b556a"></p>
<h3 id="learning-a-decision-tree" data-line="694" class="code-line">Learning a Decision Tree</h3>
<ul>
<li data-line="696" class="code-line">Incrementally split training data</li>
<li data-line="697" class="code-line">Solve subproblems</li>
<li data-line="698" class="code-line">Hard: how to split data?</li>
<li data-line="699" class="code-line">Criteria for good decision tree:
<ul>
<li data-line="700" class="code-line">small decision tree</li>
<li data-line="701" class="code-line">good classification (from training data, low error)</li>
<li data-line="702" class="code-line">good generalization (from testing data, low error)</li>
</ul>
</li>
</ul>
<pre><code data-line="704" class="code-line language-js"><div>\\ Input X, Output Y, Test Data E
\\ <span class="hljs-built_in">Function</span> returns a tree &lt;X, T_1, ..., T_n&gt; where T<span class="hljs-string">'s are decision trees

func DecisionTreeLearner (X, Y, E){
  if (&lt;Stopping Criteria&gt;){
    return PointEstimate(Y, E);
  }else{
    select X_i from X
    for (val x_j of X_i){
      E_i = All E where X_i = x_j;
      T_j = DecisionTreeLearner(X\{X_i}, Y, E_i);
    }
    return &lt;X_i, T_1,...,T_j&gt;
  }
}
</span></div></code></pre>
<h3 id="difficulties" data-line="722" class="code-line">Difficulties</h3>
<ol>
<li data-line="724" class="code-line">Stopping Criteria
<ul>
<li data-line="725" class="code-line">How to decide to stop splitting?</li>
<li data-line="726" class="code-line">No more features or when performance on training data is good enough</li>
</ul>
</li>
<li data-line="727" class="code-line">Selection of Features
<ul>
<li data-line="728" class="code-line">Want to choose feature so that smallest tree happen</li>
<li data-line="729" class="code-line">Actual: Myopicallu split -&gt; allowed one split, which feature gives the best</li>
<li data-line="730" class="code-line">heuristics
<ul>
<li data-line="731" class="code-line">Most even split</li>
<li data-line="732" class="code-line">Maximum information gain</li>
<li data-line="733" class="code-line">GINI index etc.</li>
</ul>
</li>
</ul>
</li>
</ol>
<p data-line="735" class="code-line">Aside: Information Theory</p>
<ul>
<li data-line="737" class="code-line">Bit are binary</li>
<li data-line="738" class="code-line">n bit can distinguish <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> items
<ul>
<li data-line="739" class="code-line">Can use probability to determine what is the expected bits needed</li>
</ul>
</li>
<li data-line="740" class="code-line">Need <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo>(</mo><mi>P</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">-log_2(P(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> to encode <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span></eq></li>
<li data-line="741" class="code-line">Each symbol needs <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><mi>P</mi><mo>(</mo><mi>x</mi><mo>)</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo>(</mo><mi>P</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">-P(x)log_2(P(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li>
<li data-line="742" class="code-line">Transmitting an entire sequence we need average: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mi>x</mi></msub><mo>(</mo><mo>−</mo><mi>P</mi><mo>(</mo><mi>x</mi><mo>)</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo>(</mo><mi>P</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_x(-P(x)log_2(P(x)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0016819999999999613em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>
<ul>
<li data-line="743" class="code-line">Information Content (Entropy)</li>
</ul>
</li>
<li data-line="744" class="code-line">Information Gain
<ul>
<li data-line="745" class="code-line">We can use this to calculate maximum information gain!</li>
<li data-line="746" class="code-line">Given set E of N training samples with output feature Y<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>Y</mi><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><mfrac><msub><mi>N</mi><mi>i</mi></msub><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">P(Y=y_i) = P(y_i) = \frac{N_i}{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.233431em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8884309999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.10903em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li data-line="747" class="code-line">Total Information Content: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo>(</mo><mi>E</mi><mo>)</mo><mo>=</mo><msub><mo>∑</mo><msub><mi>y</mi><mi>i</mi></msub></msub><mo>(</mo><mo>−</mo><mi>P</mi><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo>(</mo><mi>P</mi><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">I(E) = \sum_{y_i}(-P(y_i)log_2(P(y_i)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.185818em;vertical-align:-0.43581800000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0016819999999999613em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li>
<li data-line="748" class="code-line">We want to find the maximum difference between <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo>(</mo><mi>E</mi><mo>)</mo><mo>−</mo><mi>I</mi><mo>(</mo><msub><mi>E</mi><mrow><mi>s</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">I(E) - I(E_{split})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
<ul>
<li data-line="749" class="code-line">Maximum information gain!!</li>
</ul>
</li>
<li data-line="750" class="code-line">ie. if E was split up in to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">E_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">E_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo>(</mo><msub><mi>E</mi><mrow><mi>s</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi></mrow></msub><mo>)</mo><mo>=</mo><mfrac><msub><mi>N</mi><mn>1</mn></msub><mi>N</mi></mfrac><mi>I</mi><mo>(</mo><msub><mi>E</mi><mn>1</mn></msub><mo>)</mo><mo>+</mo><mfrac><msub><mi>N</mi><mn>2</mn></msub><mi>N</mi></mfrac><mi>I</mi><mo>(</mo><msub><mi>E</mi><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">I(E_{split}) = \frac{N_1}{N}I(E_1) + \frac{N_2}{N}I(E_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.233431em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8884309999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.10903em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.233431em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8884309999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.10903em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
</ul>
<ol>
<li data-line="752" class="code-line">Point Estimate (final value at leaf)
<ul>
<li data-line="753" class="code-line">Just return the point estimate (mean, median, most likely classification etc.)</li>
</ul>
</li>
<li data-line="754" class="code-line">How to reduce # of branches</li>
</ol>
<h2 id="use-a-priority-queue" data-line="756" class="code-line">Use a Priority Queue</h2>
<p data-line="758" class="code-line">Sort leaves using a PQ ranked by information gain with best feature at each leaf -&gt; expand only the top of queue first!</p>
<ul>
<li data-line="760" class="code-line">still store as tree, but basically when going through values, only check the best information gain and expand it (so not all subtree are expanded in that order with all choices done)</li>
</ul>
<p data-line="762" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/8.png" alt="image" class="loading" id="image-hash-039641d5f457d353b05d19929a1385e733cea67d367f80274afe3b141d4fe847"></p>
<h3 id="overfitting" data-line="764" class="code-line">Overfitting</h3>
<ul>
<li data-line="766" class="code-line">
<p data-line="766" class="code-line">When there lacks data, and it will not generalize well as we found correlation when there should not be. The more complex the tree, the more overfitting can likely happen.</p>
</li>
<li data-line="767" class="code-line">
<p data-line="767" class="code-line">Avoiding them</p>
<ul>
<li data-line="768" class="code-line">Penalty to complexity</li>
<li data-line="769" class="code-line">Add some prior data</li>
<li data-line="770" class="code-line">Cross validation</li>
</ul>
</li>
<li data-line="771" class="code-line">
<p data-line="771" class="code-line">Error can be caused by</p>
<ul>
<li data-line="773" class="code-line">Bias -&gt; representation bias (too simple), seach bias (not enough depth)</li>
<li data-line="774" class="code-line">variance -&gt; lack of data</li>
<li data-line="775" class="code-line">noise -&gt; process generating data is bad</li>
<li data-line="776" class="code-line">bias variance trade off -&gt; both</li>
</ul>
</li>
<li data-line="778" class="code-line">
<p data-line="778" class="code-line">Capacity: capacity of model is ability to fit a wide variety of function: inverse of bias -&gt; high capacity model has low bias!</p>
</li>
</ul>
<h4 id="cross-validation" data-line="780" class="code-line">Cross Validation</h4>
<ul>
<li data-line="782" class="code-line">split training data into training and validation set!
<ul>
<li data-line="783" class="code-line">have a pretend test set!</li>
<li data-line="784" class="code-line">optimize to perform well on validation set</li>
<li data-line="785" class="code-line"></li>
</ul>
</li>
</ul>
<h3 id="supervised-ml-ii" data-line="787" class="code-line">Supervised ML II</h3>
<p data-line="789" class="code-line">Linear Regression</p>
<ul>
<li data-line="791" class="code-line">Output is a linear function of input feature</li>
<li data-line="792" class="code-line">Goal is to find weights that minimizes Error(E, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>w</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.56778em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span></span></span></span>)
<ul>
<li data-line="793" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>w</mi><mo>ˉ</mo></mover><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>w</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\bar{w} = w_0, w_1, ..., w_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.56778em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &lt;- weights</li>
<li data-line="794" class="code-line">The sum of squares error <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mrow><mi>e</mi><mo>∈</mo><mi>E</mi></mrow></msub><mo>(</mo><mi>Y</mi><mo>(</mo><mi>e</mi><mo>)</mo><mo>−</mo><mstyle mathcolor="#cc0000"><mtext>\har</mtext></mstyle><mi>Y</mi><mo>(</mo><mi>e</mi><mo>)</mo><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sum_{e \in E}(Y(e)-\har{Y}(e))^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.07708em;vertical-align:-0.32708000000000004em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord text" style="color:#cc0000;"><span class="mord" style="color:#cc0000;">\har</span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
</ul>
<p data-line="796" class="code-line">Gradient Descend</p>
<ul>
<li data-line="798" class="code-line">find minimum analytically through gradient descent -&gt; a step size/learning rate</li>
<li data-line="799" class="code-line">incremental -&gt; go through each <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span></eq> iteratively</li>
<li data-line="800" class="code-line">stochastic -&gt; chosen <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span></eq> randomly</li>
<li data-line="801" class="code-line">Batched -&gt; process batch of size <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></eq> before updating weights
<ul>
<li data-line="802" class="code-line">if <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></eq> is all data -&gt; gradient descent</li>
<li data-line="803" class="code-line">if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> -&gt; incremental</li>
</ul>
</li>
</ul>
<h3 id="linear-classifier" data-line="805" class="code-line">Linear Classifier</h3>
<ul>
<li data-line="807" class="code-line">No point making prediction of less than 0 or greater than 1 for binary classification i.e.</li>
<li data-line="808" class="code-line">f -&gt; activation function
<ul>
<li data-line="809" class="code-line">for example f(x) = {1, 0} wrapped around <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9467699999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span></span></span></span></li>
<li data-line="810" class="code-line">sigmoid -&gt; S shaped</li>
</ul>
</li>
</ul>
<h3 id="linearly-separable" data-line="812" class="code-line">Linearly Separable</h3>
<ul>
<li data-line="814" class="code-line">if there's a hyperplane where classification is true on one side and false on other side -&gt; Linearly Separable!
<ul>
<li data-line="815" class="code-line">Also can be multi linearly separable</li>
</ul>
</li>
<li data-line="816" class="code-line">Kernel Trick - Mercer's Theorem
<ul>
<li data-line="817" class="code-line">Dot product in the new space = function(points) in old space -&gt; Kernel</li>
<li data-line="818" class="code-line">We dont need to know the exact transformation we only need to know how to compute the Kernel value (Kernel is the new dimension)</li>
</ul>
</li>
</ul>
<h3 id="support-vector-machines" data-line="820" class="code-line">Support Vector Machines</h3>
<ul>
<li data-line="822" class="code-line">Also uses Kernel trick to give it seperations on hyperplanes</li>
</ul>
<p data-line="824" class="code-line">Neural Networks</p>
<ul>
<li data-line="826" class="code-line">connect many simple units</li>
<li data-line="827" class="code-line">Errors made are propagated backwards to change weights (back propagation)</li>
<li data-line="828" class="code-line">many layers</li>
</ul>
<p data-line="830" class="code-line">Neural Network Basics</p>
<ul>
<li data-line="832" class="code-line">each node receives set of inputs and already has a set of weights
<ul>
<li data-line="833" class="code-line">weights = number of parents + 1 (since <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w_0=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> from Lin Reg)</li>
<li data-line="834" class="code-line">output is the activation function output
<ul>
<li data-line="835" class="code-line">activation: step, sigmoid, rectified linear</li>
</ul>
</li>
</ul>
</li>
</ul>
<p data-line="837" class="code-line">Deep Neural Network just has multiple layers of these functions and temp Lin Reg results</p>
<h4 id="back-propagation" data-line="839" class="code-line">Back propagation</h4>
<ul>
<li data-line="841" class="code-line">
<p data-line="841" class="code-line">stochastic gradient descent (random chosen) with learning rate</p>
</li>
<li data-line="843" class="code-line">
<p data-line="843" class="code-line">Skipped???</p>
</li>
</ul>
<h3 id="composite-models" data-line="845" class="code-line">Composite Models</h3>
<ul>
<li data-line="847" class="code-line">Random Forests
<ul>
<li data-line="848" class="code-line">Each decision tree is different, different feature/splitting criteria and training set</li>
</ul>
</li>
<li data-line="849" class="code-line">Ensemble learning
<ul>
<li data-line="850" class="code-line">combination of base level algorithms</li>
</ul>
</li>
<li data-line="851" class="code-line">Boosting: sequence of learning
<ul>
<li data-line="852" class="code-line">each learner trained to fit examples that the previous is bad at</li>
<li data-line="853" class="code-line">early, allow false positive, but eliminate true possitive</li>
<li data-line="854" class="code-line">later, harder problem, but set of example more focused</li>
</ul>
</li>
</ul>
<h2 id="reasoning-under-uncertainty" data-line="856" class="code-line">Reasoning Under Uncertainty</h2>
<ul>
<li data-line="858" class="code-line">Agents do not know everything</li>
<li data-line="859" class="code-line">decisions made in absence of information or in noisy information</li>
</ul>
<p data-line="861" class="code-line">Frequentist vs Bayesian</p>
<ul>
<li data-line="863" class="code-line">Frequentist: looks at what has happened, only uses history, and uncertainty is pertaining to the world</li>
<li data-line="864" class="code-line">Bayesian: looks at own belief which is based on previous experiences, uncertainty is pertaining to knowledge</li>
</ul>
<p data-line="866" class="code-line">Bayesian would look at all data to make belief choices, frequentist would just look at own past data</p>
<h3 id="features" data-line="868" class="code-line">Features</h3>
<ul>
<li data-line="870" class="code-line">Describe World is described in states
<ul>
<li data-line="871" class="code-line">or as product of a set of features (attributes/random variables)</li>
</ul>
</li>
<li data-line="872" class="code-line">Number of states: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mtext>number of binary features</mtext></msup></mrow><annotation encoding="application/x-tex">2^\text{number of binary features}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">number of binary features</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li data-line="873" class="code-line">Factorize to get to feature values</li>
</ul>
<p data-line="875" class="code-line">Note: Probability is the measure of ignorance</p>
<p data-line="877" class="code-line">Independence can reduce the numbers needed to calculate probability distributions</p>
<p data-line="879" class="code-line">Note: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(x|y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> is probability of X = x given Y = y</p>
<h3 id="rules" data-line="881" class="code-line">Rules</h3>
<p data-line="883" class="code-line">Bayes Rule: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>B</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>A</mi><mo>)</mo><mi mathvariant="normal">/</mi><mi>P</mi><mo>(</mo><mi>B</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(A|B) = P(B|A)P(A)/P(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span> since <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>B</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(A, B) = P(A|B)P(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></p>
<p data-line="885" class="code-line">Independence -&gt; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>A</mi><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi>B</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(A) = P(A|B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></p>
<p data-line="887" class="code-line">Expected Values: expected value of a function on X -&gt; V(X)</p>
<ul>
<li data-line="889" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo>(</mo><mi>V</mi><mo>)</mo><mo>=</mo><msub><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi>d</mi><mi>o</mi><mi>m</mi><mo>(</mo><mi>X</mi><mo>)</mo></mrow></msub><mi>P</mi><mo>(</mo><mi>X</mi><mo>)</mo><mi>V</mi><mo>(</mo><mi>X</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">E(V) = \sum_{x \in dom(X)}P(X)V(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.22471em;vertical-align:-0.47471em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">m</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p data-line="891" class="code-line">Values of independence -&gt; reduces representation and inference from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></p>
<ul>
<li data-line="893" class="code-line">mutual independence is rare, but most have conditional independence</li>
</ul>
<h2 id="bayesian-network-aka-belief-networks" data-line="895" class="code-line">Bayesian Network (AKA Belief Networks)</h2>
<ul>
<li data-line="897" class="code-line">Are Direct Acyclic Graph</li>
<li data-line="898" class="code-line">Encodes dependencies in a graphical way</li>
<li data-line="899" class="code-line">Edges: P(X|parents(X))</li>
</ul>
<p data-line="901" class="code-line">Correlation and Causality: Directed links are causal, it doesnt matter what causes what!</p>
<h3 id="chain-rule" data-line="903" class="code-line">Chain rule</h3>
<p data-line="905" class="code-line">Because of conditional probabilities and independence: after chain rule we can also simplify!</p>
<p data-line="907" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/9.png" alt="image" class="loading" id="image-hash-819e9bac26909ac7fbf00857877cc02ae2b6de92e388bc2e33cd4e6da2c48799"></p>
<h3 id="bayesian-networks" data-line="909" class="code-line">Bayesian Networks</h3>
<ul>
<li data-line="911" class="code-line">Contains a DAG and a set of CPT (Conditional Probability Tables)</li>
<li data-line="912" class="code-line">Structure implies that X is conditionally independent of all its non- descendants given parents</li>
</ul>
<p data-line="914" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/10.png" alt="image" class="loading" id="image-hash-438ed5302195a3276cd5cc919918610c997744f273c0bcb8546902ab01cd4d5f"></p>
<ul>
<li data-line="916" class="code-line">DB and Test B are independent if Report is observed</li>
<li data-line="917" class="code-line">Test A and Test B are independent if Cancer is observed</li>
<li data-line="918" class="code-line">Malfunction and Cancer and independent if Test B is <strong>not</strong> observed</li>
</ul>
<h3 id="testing-independence" data-line="920" class="code-line">Testing Independence</h3>
<ul>
<li data-line="922" class="code-line">
<p data-line="922" class="code-line">D-seperation: set of variables E d-seperates X and Y if it blocks every undirected path in BN</p>
<ul>
<li data-line="924" class="code-line">Basically &quot;Blocked&quot; means that they are independent</li>
</ul>
</li>
<li data-line="926" class="code-line">
<p data-line="926" class="code-line"><strong>Markov Blanket</strong> - minimal set of nodes that d-seperates <em>v</em> from all other variables</p>
<ul>
<li data-line="928" class="code-line">parents, children and other parents of children</li>
</ul>
</li>
<li data-line="930" class="code-line">
<p data-line="930" class="code-line">2 children -&gt; the leaf node may change belief for the other one if the parent is not observed</p>
</li>
<li data-line="931" class="code-line">
<p data-line="931" class="code-line">2 parent -&gt; the parent node may change belief for the other one if the child (or its children) is observed</p>
<ul>
<li data-line="932" class="code-line">this is the only case where the children can fully block a parent.</li>
</ul>
</li>
</ul>
<p data-line="934" class="code-line">Reducing the number of dependencies reduces the number of variable we need to look at for the chain thing</p>
<p data-line="936" class="code-line">&quot;Car starting problem&quot; - independence quiz</p>
<p data-line="938" class="code-line">slide 29</p>
<ul>
<li data-line="940" class="code-line">TravelSubway and Thermometer (given no evidence)? Dependent</li>
<li data-line="941" class="code-line">TravelSubway and Thermometer (given Flu or Fever)? Independent</li>
<li data-line="942" class="code-line">TravelSubway and Malaria (given Fever)? Dependent</li>
<li data-line="943" class="code-line">TravelSubway and ExoticTrip (given Jaundice)? Independent</li>
<li data-line="944" class="code-line">TravelSubway and ExoticTrip (given Jaundice and Thermometer)? Dependent</li>
<li data-line="945" class="code-line">TravelSubway and ExoticTrip (given Malaria and Thermometer)? Independent</li>
</ul>
<p data-line="947" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>h</mi><mi mathvariant="normal">∣</mi><mi>e</mi><mo>)</mo><mo>∝</mo><mi>P</mi><mo>(</mo><mi>e</mi><mi mathvariant="normal">∣</mi><mi>h</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(h|e) \propto P(e|h)P(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mord">∣</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord">∣</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span></span></span></span></p>
<p data-line="949" class="code-line">^ e shows h (e causes h)</p>
<p data-line="951" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>e</mi><mo>)</mo><mo>=</mo><msub><mo>∑</mo><mi>h</mi></msub><mi>P</mi><mo>(</mo><mi>h</mi><mo separator="true">,</mo><mi>e</mi><mo>)</mo><mo>=</mo><msub><mo>∑</mo><mi>h</mi></msub><mi>P</mi><mo>(</mo><mi>e</mi><mi mathvariant="normal">∣</mi><mi>h</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(e) = \sum_hP(h,e) = \sum_h P(e|h)P(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1863979999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1863979999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord">∣</span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">h</span><span class="mclose">)</span></span></span></span></p>
<p data-line="953" class="code-line">Polytree algo: whats shown in class, figure out what is dependent, then chain rule, More generally, Variable Elimination Algorithm</p>
<p data-line="955" class="code-line">slide 38</p>
<p data-line="957" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>F</mi><mi mathvariant="normal">∣</mi><mi>J</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo>)</mo><mo>∝</mo><mi>P</mi><mo>(</mo><mi>F</mi><mo separator="true">,</mo><mi>J</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(F|J=true)\propto P(F, J=true)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></p>
<p data-line="959" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mi>c</mi></msub><mi>P</mi><mo>(</mo><mi>F</mi><mo separator="true">,</mo><mi>C</mi><mo separator="true">,</mo><mi>J</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_cP(F,C, J=true)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0016819999999999613em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></p>
<p data-line="961" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mi>c</mi></msub><mi>P</mi><mo>(</mo><mi>J</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">∣</mi><mi>F</mi><mo separator="true">,</mo><mi>C</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>C</mi><mo separator="true">,</mo><mi>F</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>F</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_cP(J=true|F,C)P(C, F)P(F)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0016819999999999613em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mclose">)</span></span></span></span></p>
<p data-line="963" class="code-line">can expand <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>C</mi><mo separator="true">,</mo><mi>F</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(C,F)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mclose">)</span></span></span></span> because J is not observed locally</p>
<p data-line="965" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mi>c</mi></msub><mi>P</mi><mo>(</mo><mi>J</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">∣</mi><mi>F</mi><mo separator="true">,</mo><mi>C</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>C</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>F</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_cP(J=true|F,C)P(C)P(F)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0016819999999999613em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mclose">)</span></span></span></span></p>
<p data-line="967" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>F</mi><mo>)</mo><msub><mo>∑</mo><mi>c</mi></msub><mi>P</mi><mo>(</mo><mi>J</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">∣</mi><mi>F</mi><mo separator="true">,</mo><mi>C</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>C</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(F)\sum_cP(J=true|F,C)P(C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.0016819999999999613em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></p>
<ul>
<li data-line="969" class="code-line">F=true: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0.1</mn><mo>[</mo><mn>0.95</mn><mo>×</mo><mn>0.0001</mn><mo>+</mo><mn>0.99</mn><mo>×</mo><mn>0.9999</mn><mo>]</mo><mo>=</mo><mn>0.099</mn></mrow><annotation encoding="application/x-tex">0.1[0.95\times0.0001+0.99\times0.9999]=0.099</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mopen">[</span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span><span class="mord">9</span><span class="mord">9</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">9</span><span class="mord">9</span></span></span></span></li>
<li data-line="970" class="code-line">F=false: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0.9</mn><mo>[</mo><mn>0.99</mn><mo>×</mo><mn>0.0001</mn><mo>+</mo><mn>0.01</mn><mo>×</mo><mn>0.9999</mn><mo>]</mo><mo>=</mo><mn>0.0091</mn></mrow><annotation encoding="application/x-tex">0.9[0.99\times0.0001+0.01\times0.9999]=0.0091</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mopen">[</span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span><span class="mord">9</span><span class="mord">9</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">9</span><span class="mord">1</span></span></span></span></li>
</ul>
<p data-line="972" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>F</mi><mi mathvariant="normal">∣</mi><mi>J</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo>)</mo><mo>=</mo><mfrac><mn>0.099</mn><mrow><mn>0.099</mn><mo>+</mo><mn>0.0091</mn></mrow></mfrac><mo>=</mo><mn>0.92</mn></mrow><annotation encoding="application/x-tex">P(F|J=true) = \frac{0.099}{0.099+0.0091} = 0.92</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">0</span><span class="mord mtight">9</span><span class="mord mtight">9</span><span class="mbin mtight">+</span><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">9</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">0</span><span class="mord mtight">9</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">2</span></span></span></span></p>
<p data-line="974" class="code-line">Normalization Factor = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0.099</mn><mo>+</mo><mn>0.0091</mn><mo>=</mo><msub><mo>∑</mo><mi>F</mi></msub><mi>P</mi><mo>(</mo><mi>F</mi><mo separator="true">,</mo><mi>J</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">0.099+0.0091 = \sum_FP(F, J=true)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">9</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">9</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></p>
<h3 id="factors" data-line="976" class="code-line">Factors</h3>
<p data-line="978" class="code-line">Factors does not have to add up to 1, will bring in NF (Normalizing factor) last minute</p>
<ul>
<li data-line="980" class="code-line">They can have certain variables already set</li>
<li data-line="981" class="code-line">product of Factor -&gt; cartesian product etc.</li>
<li data-line="982" class="code-line">sum out variable -&gt; add where the X is equal (remove X from the factor)</li>
<li data-line="983" class="code-line">to be efficient: sum then product! (sums of product needs to be done effectively)</li>
</ul>
<h3 id="variable-elimination-algo" data-line="985" class="code-line">Variable Elimination Algo</h3>
<ul>
<li data-line="987" class="code-line">
<p data-line="987" class="code-line">construct all factors</p>
</li>
<li data-line="988" class="code-line">
<p data-line="988" class="code-line">set all known variable</p>
</li>
<li data-line="989" class="code-line">
<p data-line="989" class="code-line">sum out according to elimination ordering</p>
</li>
<li data-line="990" class="code-line">
<p data-line="990" class="code-line">multiply remaining, normalize resulting factor!</p>
</li>
<li data-line="992" class="code-line">
<p data-line="992" class="code-line">Dependent on elimination ordering</p>
<ul>
<li data-line="993" class="code-line">polytree: work outside in!</li>
<li data-line="994" class="code-line">NP-Hard problem generally</li>
</ul>
</li>
</ul>
<h4 id="variable-ordering" data-line="996" class="code-line">Variable ordering</h4>
<ul>
<li data-line="998" class="code-line">eliminate singly-connected nodes first</li>
<li data-line="999" class="code-line">relevance - eliminate those not needed (duh!)</li>
</ul>
<h3 id="l8-uncertainty-part-ii" data-line="1001" class="code-line">L8 Uncertainty Part II</h3>
<h3 id="probability-and-time" data-line="1003" class="code-line">Probability and Time:</h3>
<ul>
<li data-line="1005" class="code-line">Node repeats over time, explicit encoding of time</li>
<li data-line="1006" class="code-line">Chain has length: amount of time you want to model</li>
<li data-line="1007" class="code-line">EG: Markov Chain
<ul>
<li data-line="1008" class="code-line">Markov assumes that each time is only directly dependent on the previous time (note that the prob chain still chains...)</li>
</ul>
</li>
</ul>
<p data-line="1010" class="code-line">Hidden Markov Models</p>
<ul>
<li data-line="1012" class="code-line">Add observations <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>O</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">O_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> -&gt; always observed</li>
<li data-line="1013" class="code-line">Given a sequence of observations we can use
<ul>
<li data-line="1014" class="code-line">filtering: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>O</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>O</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(S_t|O_1, ..., O_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li data-line="1015" class="code-line">smoothing: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>S</mi><mi>k</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>O</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>O</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(S_k|O_1, ..., O_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, k &lt; t</li>
</ul>
</li>
<li data-line="1016" class="code-line">Used for speech recognition</li>
</ul>
<p data-line="1018" class="code-line">Belief Monitoring in HMM</p>
<ul>
<li data-line="1020" class="code-line">Filtering</li>
</ul>
<p data-line="1022" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/11.png" alt="image" class="loading" id="image-hash-486e94d29044b6f2a726bd520800e33e518296e711703b075a3c24d79eff66a9"></p>
<ul>
<li data-line="1024" class="code-line">Smoothing</li>
</ul>
<p data-line="1026" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/12.png" alt="image" class="loading" id="image-hash-0d0f946ebb771bd0bfca4590f13c868077028a993c49b4dab42cb8618311ad09"></p>
<p data-line="1028" class="code-line">Filtering is when you are only allowed to use past data to make an estimate. Smoothing is when you are allowed to use both past and future data to make an estimate.</p>
<p data-line="1030" class="code-line">A Markov process is one where all future states can be determined by only the current state, you do not need to know anything about the past history. A hidden-markov model is one where you don't observe the states directly but only some output dependent on the state.</p>
<h3 id="dynamic-bayesian-networks" data-line="1032" class="code-line">Dynamic Bayesian Networks</h3>
<ul>
<li data-line="1034" class="code-line">problematic when time and event driven -&gt; too many variables now , VE does not work!</li>
<li data-line="1035" class="code-line">IE Localization is hard (robot finding where he is based on sensors)</li>
</ul>
<h3 id="stochastic-simulation" data-line="1037" class="code-line">Stochastic Simulation</h3>
<ul>
<li data-line="1039" class="code-line">idea: generation probability from samples, sample the past probability from the past actions/results</li>
<li data-line="1040" class="code-line">since some models are large, doing VE is too slow so this is better.</li>
<li data-line="1041" class="code-line">Generate random samples and compute values of interest from samples, not original network</li>
<li data-line="1042" class="code-line">We need a good estimation to get error less than an amount:</li>
</ul>
<p data-line="1044" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/13.png" alt="image" class="loading" id="image-hash-0f96c634bd6fba048cca72b1b9d10c501a2a4fa010381bf1799a14af152b10ed"></p>
<ul>
<li data-line="1046" class="code-line">This is basically the process to show why Conditional Probability Tables is better.</li>
</ul>
<h4 id="forward-sampling" data-line="1048" class="code-line">Forward Sampling</h4>
<ul>
<li data-line="1050" class="code-line">Sample variables one at a time, starting from parent then to child</li>
<li data-line="1051" class="code-line">Given all parent's value, then sample from the probability of X given parents.</li>
<li data-line="1052" class="code-line">I.E P(H=y | E=x) = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>N</mi><mi>u</mi><mi>m</mi><mo>(</mo><mi>H</mi><mo>=</mo><mi>y</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>E</mi><mo>=</mo><mi>x</mi><mo>)</mo></mrow><mrow><mi>N</mi><mi>u</mi><mi>m</mi><mo>(</mo><mi>E</mi><mo>=</mo><mi>x</mi><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{Num(H=y and E=x)}{Num(E=x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">m</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">m</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li data-line="1053" class="code-line">As number of samples goes up, it will get more accurate</li>
<li data-line="1054" class="code-line">Sample the whole thing based on the topological order of the variables.</li>
</ul>
<h4 id="rejection-sampling" data-line="1056" class="code-line">Rejection Sampling</h4>
<ul>
<li data-line="1058" class="code-line">Forward sampling except the samples with unrequested values (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mi mathvariant="normal">≠</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">E\ne x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel latin_fallback"≯</span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>) will get rejected and tossed out. Non-rejected are distributed based on the posterior prob.</li>
<li data-line="1059" class="code-line">NOTE: in the Hoeffding bound, n is the number of non-rejected samples</li>
</ul>
<p data-line="1061" class="code-line">Instead you can also just put in weights in place of the sampling, hence not needing to generate majority of it</p>
<p data-line="1063" class="code-line">Proposal Distribution q(a)</p>
<ul>
<li data-line="1065" class="code-line">We can give each sample the new weight of P(a)/q(a)</li>
<li data-line="1066" class="code-line">Useful if P(A) hard to sample, we can then look back and find out what to do with q(A) after.</li>
<li data-line="1067" class="code-line">rejection sampling uses this method,</li>
<li data-line="1068" class="code-line">We sometimes want to skew the proposal based on prior knowledge.</li>
</ul>
<h4 id="stochastic-sampling-for-hmms-and-other-dbns" data-line="1070" class="code-line">Stochastic Sampling for HMMs (and other DBNS)</h4>
<p data-line="1072" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/14.png" alt="image" class="loading" id="image-hash-934e89c48110efbd3791f3a82c8014e556b8a2be21750ea27380d62217c77254"></p>
<p data-line="1074" class="code-line">Sequential Monte Carlo or &quot;Particle Filter&quot;</p>
<ul>
<li data-line="1076" class="code-line">Sequential Sampling (stochastic)</li>
<li data-line="1077" class="code-line">keep track of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(S_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> and represent it with a set of variables
<ul>
<li data-line="1078" class="code-line">update this as new observation arrives <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>o</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">o_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></li>
<li data-line="1079" class="code-line">predict <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>S</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(S_{t+1}|S_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li data-line="1080" class="code-line">compute new weights from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>o</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(o_{t+1}|S_{t+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> and resample!</li>
</ul>
</li>
</ul>
<ul>
<li data-line="1082" class="code-line">Predict -&gt; Spread -&gt; Evidence (-&gt; Resample)</li>
</ul>
<p data-line="1084" class="code-line">performance of algo dependent on resampling method</p>
<ul>
<li data-line="1086" class="code-line">avoid degeneracy of data</li>
</ul>
<h1 id="l12-learning-under-uncertainty-1" data-line="1088" class="code-line">L12, Learning Under Uncertainty 1</h1>
<h2 id="bayesian-learning" data-line="1090" class="code-line">Bayesian Learning</h2>
<ul>
<li data-line="1092" class="code-line">
<p data-line="1092" class="code-line">Premise</p>
<ul>
<li data-line="1094" class="code-line">Have a bunch of hypothesis OR models (note models are hypothesis and have distribution of prior probabilities)</li>
<li data-line="1095" class="code-line">Assume all are correct at the start</li>
<li data-line="1096" class="code-line">See which one is most correct</li>
<li data-line="1097" class="code-line">Compute the expected prediction given distribution</li>
</ul>
</li>
<li data-line="1099" class="code-line">
<p data-line="1099" class="code-line">Refine each model according to Data, then find Y from the given X input and the model.</p>
</li>
<li data-line="1101" class="code-line">
<p data-line="1101" class="code-line">Prior = P(H)</p>
</li>
<li data-line="1102" class="code-line">
<p data-line="1102" class="code-line">Likelihood = P(d|H)</p>
<ul>
<li data-line="1103" class="code-line">Evidence: d = {<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">d_1, d_2,...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span>}</li>
</ul>
</li>
<li data-line="1104" class="code-line">
<p data-line="1104" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>H</mi><mi mathvariant="normal">∣</mi><mi>d</mi><mo>)</mo><mo>∝</mo><mi>P</mi><mo>(</mo><mi>d</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>H</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(H|d) \propto P(d|H)P(H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord">∣</span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span></p>
</li>
</ul>
<h3 id="predictions" data-line="1106" class="code-line">Predictions</h3>
<ul>
<li data-line="1108" class="code-line">Predictions are weighted averages of the predictions of the individual hypotheses</li>
<li data-line="1109" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>X</mi><mi mathvariant="normal">∣</mi><mi>d</mi><mo>)</mo><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><mi>P</mi><mo>(</mo><mi>X</mi><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mi>i</mi></msub><mo>)</mo><mi>P</mi><mo>(</mo><msub><mi>h</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>d</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(X|d) = \sum_i P(X|h_i)P(h_i|d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span></span>
<ul>
<li data-line="1110" class="code-line">Basically serves as intermediary step between data and hypothesis</li>
</ul>
</li>
<li data-line="1111" class="code-line">Posterior probability changes as more data comes in, and prediction of X becomes more accurate as the posterior increases.</li>
<li data-line="1112" class="code-line">NOTE: A posterior probability, in Bayesian statistics, is the revised or updated probability of an event occurring after taking into consideration new information.</li>
</ul>
<p data-line="1114" class="code-line">Bayesian Learning is:</p>
<ul>
<li data-line="1116" class="code-line">Optimal: given prior, Bayesian prediction is often the best one</li>
<li data-line="1117" class="code-line">No Overfitting: prior/likelihood penalize complex hypothesis!</li>
</ul>
<p data-line="1119" class="code-line">Problem: if hypothesis space large, it is very problematic</p>
<ul>
<li data-line="1121" class="code-line">solution: approximate Bayesian Learning</li>
</ul>
<h3 id="maximum-a-posteriori" data-line="1123" class="code-line">Maximum A Posteriori</h3>
<ul>
<li data-line="1125" class="code-line">Make prediction based on the most probable hypothesis: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{map}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></li>
<li data-line="1126" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>p</mi></mrow></msub><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><msub><mi>h</mi><mi>i</mi></msub></msub><mi>P</mi><mo>(</mo><msub><mi>h</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>d</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">h_{map} = argmax_{h_i}P(h_i|d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span></span></li>
<li data-line="1127" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>X</mi><mi mathvariant="normal">∣</mi><mi>d</mi><mo>)</mo><mo>≈</mo><mi>P</mi><mo>(</mo><mi>X</mi><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>p</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(X|d) \approx P(X|h_{map})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li data-line="1128" class="code-line">NOTE: in Bayesian Learning, all hypothesis are used!</li>
<li data-line="1129" class="code-line">Obviously less accurate as it only uses 1 hypothesis
<ul>
<li data-line="1130" class="code-line">MAP and Bayesian will converge when data size large enough!!</li>
</ul>
</li>
<li data-line="1131" class="code-line">NOTE: this can still be intractable (problematic) as it will need to multiply a lot
<ul>
<li data-line="1132" class="code-line">i.e. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>p</mi></mrow></msub><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><msub><mi>h</mi><mi>i</mi></msub></msub><mi>P</mi><mo>(</mo><msub><mi>h</mi><mi>i</mi></msub><mo>)</mo><mi>P</mi><mo>(</mo><mi>d</mi><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">h_{map} = argmax_{h_i}P(h_i)P(d|h_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> and d is multiplied using each data point</li>
<li data-line="1133" class="code-line">You can take the log to linearize better, but even so, it is still very complex</li>
</ul>
</li>
</ul>
<h3 id="maximum-likelihood" data-line="1135" class="code-line">Maximum Likelihood</h3>
<ul>
<li data-line="1137" class="code-line">Simplify on MAP, assume uniform prior</li>
<li data-line="1138" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>m</mi><mi>a</mi><mi>p</mi></mrow></msub><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><msub><mi>h</mi><mi>i</mi></msub></msub><mi>P</mi><mo>(</mo><msub><mi>h</mi><mi>i</mi></msub><mo>)</mo><mi>P</mi><mo>(</mo><mi>d</mi><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">h_{map} = argmax_{h_i}P(h_i)P(d|h_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> where as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>m</mi><mi>l</mi></mrow></msub><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><msub><mi>h</mi><mi>i</mi></msub></msub><mi>P</mi><mo>(</mo><mi>d</mi><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">h_{ml} = argmax_{h_i}P(d|h_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li data-line="1139" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>X</mi><mi mathvariant="normal">∣</mi><mi>d</mi><mo>)</mo><mo>≈</mo><mi>P</mi><mo>(</mo><mi>X</mi><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mrow><mi>m</mi><mi>l</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(X|d) \approx P(X|h_{ml})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li data-line="1140" class="code-line">Obviously less accurate as it only uses 1 hypothesis and ignore all prior as well!
<ul>
<li data-line="1141" class="code-line">ML, MAP and Bayesian will converge when data size large enough!!</li>
</ul>
</li>
<li data-line="1142" class="code-line">more likely to get overfitting as prior is ignored
<ul>
<li data-line="1143" class="code-line">easier to find than MAP, esp looking at log linearization</li>
</ul>
</li>
</ul>
<h3 id="binomial-distribution" data-line="1145" class="code-line">Binomial Distribution</h3>
<ul>
<li data-line="1147" class="code-line">Generalizes the hypothesis space to be continuous</li>
<li data-line="1148" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">P(X=x) = \beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span></li>
<li data-line="1149" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>X</mi><mi mathvariant="normal">≠</mi><mi>x</mi><mo>)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">P(X\ne x) = 1-\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel latin_fallback"≯</span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span></li>
<li data-line="1150" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>n</mi><mi>x</mi><mo separator="true">,</mo><mi>p</mi><mi mathvariant="normal">¬</mi><mi>x</mi><mo>)</mo><mo>=</mo><mo>(</mo><mi>β</mi><msup><mo>)</mo><mi>n</mi></msup><mo>(</mo><mn>1</mn><mo>−</mo><mi>β</mi><msup><mo>)</mo><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">P(n x, p \neg x) = (\beta)^n(1-\beta)^p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord">¬</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span></span></span></span></span></span></span> for just 1 order</li>
<li data-line="1151" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>n</mi><mi>x</mi><mo separator="true">,</mo><mi>p</mi><mi mathvariant="normal">¬</mi><mi>x</mi><mo>)</mo><mo>=</mo><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>n</mi><mo>+</mo><mi>k</mi></mrow><mi>n</mi></mfrac><mo fence="true">)</mo></mrow><mo>(</mo><mi>β</mi><msup><mo>)</mo><mi>n</mi></msup><mo>(</mo><mn>1</mn><mo>−</mo><mi>β</mi><msup><mo>)</mo><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">P(n x, p \neg x) ={n+k \choose n}(\beta)^n(1-\beta)^p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord">¬</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2801179999999999em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9301079999999998em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span></span></span></span></span></span></span> for all orders</li>
</ul>
<h2 id="naive-bayesian-classifier" data-line="1153" class="code-line">Naive Bayesian Classifier</h2>
<p data-line="1155" class="code-line">IDEA: if you knew the classification you can predict value of the features</p>
<ul>
<li data-line="1157" class="code-line">
<p data-line="1157" class="code-line">classification problem</p>
</li>
<li data-line="1159" class="code-line">
<p data-line="1159" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>)</mo><mo>∝</mo><mi>P</mi><mo>(</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">∣</mi><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(Class | X_1, X_2, ...) \propto P(X_1, X_2, ... | Class)P(Class)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span></p>
</li>
</ul>
<p data-line="1161" class="code-line">Naive Bayesian Classifer:</p>
<ul>
<li data-line="1163" class="code-line">
<p data-line="1163" class="code-line">Assume that X's are independent of each other given a class (hence the word Naive)</p>
</li>
<li data-line="1164" class="code-line">
<p data-line="1164" class="code-line">Need <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(Class)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>X</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(X_i | Class)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> for each <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
</li>
<li data-line="1165" class="code-line">
<p data-line="1165" class="code-line">Email example, for instance (User Action -&gt; Length, Reply, At Home etc.)</p>
</li>
<li data-line="1167" class="code-line">
<p data-line="1167" class="code-line">Predict Class C based on Attribute A's</p>
</li>
</ul>
<p data-line="1169" class="code-line">Example (email example):</p>
<ul>
<li data-line="1171" class="code-line">Each sub <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>X</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(X_i | Class)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> = # of times <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> happen / # of times Class happened</li>
</ul>
<h2 id="minimum-description-length" data-line="1173" class="code-line">Minimum Description Length</h2>
<ul>
<li data-line="1175" class="code-line">Bayesian Learning: update the posterior (update the probability given new information)</li>
<li data-line="1176" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>H</mi><mi mathvariant="normal">∣</mi><mi>d</mi><mo>)</mo><mo>=</mo><mi>k</mi><mi>P</mi><mo>(</mo><mi>d</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>H</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(H|d) = kP(d|H)P(H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord">∣</span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span> (k because of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∝</mo></mrow><annotation encoding="application/x-tex">\propto</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mrel">∝</span></span></span></span>)</li>
<li data-line="1177" class="code-line">We can look at this with the log model:</li>
<li data-line="1178" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">−</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo>(</mo><mi>H</mi><mi mathvariant="normal">∣</mi><mi>d</mi><mo>)</mo><mo>=</mo><mi mathvariant="normal">−</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo>(</mo><mi>d</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo>)</mo><mi mathvariant="normal">−</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo>(</mo><mi>H</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">−logP(H|d) = − log P(d|H) − logP(H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord">∣</span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span></li>
<li data-line="1179" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo>(</mo><mi>d</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">log P(d|H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span> = number of bits to encode the data given the model</li>
<li data-line="1180" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo>(</mo><mi>H</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">log P(H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span> = number of bits to encode the model</li>
<li data-line="1181" class="code-line">MDL principle: choose model that minimize both the data encoding and the model encoding length
<ul>
<li data-line="1182" class="code-line">Useful for model selection!</li>
</ul>
</li>
</ul>
<h1 id="l13-learning-over-uncertainty-pt-2" data-line="1184" class="code-line">L13, Learning over Uncertainty pt 2</h1>
<h2 id="incomplete-data" data-line="1186" class="code-line">Incomplete Data</h2>
<ul>
<li data-line="1188" class="code-line">
<p data-line="1188" class="code-line">In the real world, many values are latent or missing!</p>
</li>
<li data-line="1189" class="code-line">
<p data-line="1189" class="code-line">Incomplete Data -&gt; Unsupervised Learning!!</p>
</li>
<li data-line="1191" class="code-line">
<p data-line="1191" class="code-line">from before: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mrow><mi>V</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>p</mi><mi>a</mi><mo>(</mo><mi>V</mi><mo>)</mo><mo>=</mo><mi>v</mi></mrow></msub><mo>=</mo><mi>P</mi><mo>(</mo><mi>V</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mi mathvariant="normal">∣</mi><mi>p</mi><mi>a</mi><mo>(</mo><mi>V</mi><mo>)</mo><mo>=</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">θ_{V =true,pa(V )=v} = P(V = true|pa(V ) = v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">e</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mclose mtight">)</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord">∣</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></p>
</li>
<li data-line="1192" class="code-line">
<p data-line="1192" class="code-line">With ML: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mrow><mi>V</mi><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi><mo separator="true">,</mo><mi>p</mi><mi>a</mi><mo>(</mo><mi>V</mi><mo>)</mo><mo>=</mo><mi>v</mi></mrow></msub><mo>=</mo><mfrac><mtext>Number of V=true and pa(V)=v</mtext><mtext>pa(V)=v</mtext></mfrac></mrow><annotation encoding="application/x-tex">θ_{V =true,pa(V )=v} = \frac{\text{Number of V=true and pa(V)=v}}{\text{pa(V)=v}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">e</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mclose mtight">)</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">pa(V)=v</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Number of V=true and pa(V)=v</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
</li>
<li data-line="1194" class="code-line">
<p data-line="1194" class="code-line">Options: when data is missing</p>
<ol>
<li data-line="1195" class="code-line">You can ignore the hidden variable, or</li>
<li data-line="1196" class="code-line">You can ignore records with missing value (which does not work with real latent values - delayed values)
<ul>
<li data-line="1197" class="code-line">You cannot just ignore records carelessly, some give valuable information (Missing Bias)</li>
<li data-line="1198" class="code-line">Often data missing is not at random, need to keep track of them too!</li>
</ul>
</li>
<li data-line="1199" class="code-line">Maximize likelihood directly
<ul>
<li data-line="1200" class="code-line">If we knew missing value, computing ML is easy again!</li>
<li data-line="1201" class="code-line">Hence &quot;Expectation Maximization&quot;</li>
</ul>
</li>
<li data-line="1202" class="code-line">Really simple version - &quot;K-means algorithm&quot;
<ul>
<li data-line="1203" class="code-line">Based on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>M</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{ML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, compute most likely missing information: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>z</mi></msub><mo>(</mo><mi>P</mi><mo>(</mo><mi>Z</mi><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mrow><mi>M</mi><mi>L</mi></mrow></msub><mo separator="true">,</mo><mi>e</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">argmax_z(P(Z|h_{ML},e))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>
<ul>
<li data-line="1204" class="code-line">now you keep going!</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="expectation-maximization" data-line="1206" class="code-line">Expectation Maximization</h2>
<ul>
<li data-line="1208" class="code-line">Guess <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>M</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{ML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, iterate
<ul>
<li data-line="1209" class="code-line">Expectation: Based on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>M</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{ML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> guess the missing values <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>Z</mi><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mrow><mi>M</mi><mi>L</mi></mrow></msub><mo separator="true">,</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(Z|h_{ML},e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></li>
<li data-line="1210" class="code-line">Maximization: Based on the expected values, refine <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>M</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{ML}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and loop</li>
</ul>
</li>
</ul>
<p data-line="1212" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/15.png" alt="image" class="loading" id="image-hash-1d1c95c5c8fbae2ff65275c06f1a13db622c6f2bcb3a57c6842aef4cd1857d55"></p>
<p data-line="1214" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/16.png" alt="image" class="loading" id="image-hash-b33d2fd7540edc15231c28ff3f5ee6a6b5657c0217b2a57877fa475dbe8a5e44"></p>
<ul>
<li data-line="1216" class="code-line">monotonically improves the likelihood with each iteration</li>
</ul>
<h2 id="k-means-algo" data-line="1218" class="code-line">k-means algo</h2>
<ul>
<li data-line="1220" class="code-line">used for hard clustering</li>
<li data-line="1221" class="code-line">starts with: training data, number of classes: k</li>
<li data-line="1222" class="code-line">output: a prediction of a value for each target feature for each class, assignment of the training data to classes</li>
</ul>
<p data-line="1224" class="code-line">Algorithm:</p>
<ul>
<li data-line="1226" class="code-line">pick k means, one per class</li>
<li data-line="1227" class="code-line">iterate until the means stop changing
<ul>
<li data-line="1228" class="code-line">assign examples to k classes based on closest mean,</li>
<li data-line="1229" class="code-line">re-estimate the k means based on the assignment</li>
</ul>
</li>
</ul>
<h2 id="augmented-data-method" data-line="1231" class="code-line">Augmented Data Method</h2>
<ul>
<li data-line="1233" class="code-line">If missing data, just augment the data with entries based on the missing value's domain and put the value as the P(missing|data)</li>
</ul>
<h2 id="m-step" data-line="1235" class="code-line">M step</h2>
<p data-line="1237" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/17.png" alt="image" class="loading" id="image-hash-9e99dbcd621aa083debaef8e9a5778d3f922b8c07a4ea1c6d34119d5b27b6f06"></p>
<p data-line="1239" class="code-line">That is the formal way of looking at it, essentially, compute statistics for each feature and class. and the compute the probabilities by normalizing it based on the values.</p>
<h2 id="general-bayes-network-em-with-missing-data" data-line="1241" class="code-line">General Bayes Network EM (with missing data)</h2>
<p data-line="1243" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/18.png" alt="image" class="loading" id="image-hash-272259424206e3f4831329240882a0523c2d7a84871b06373142d4db37b6aaca"></p>
<p data-line="1245" class="code-line">(Just formal defs)</p>
<h2 id="belief-network-structure-learning" data-line="1247" class="code-line">Belief Network Structure Learning</h2>
<p data-line="1249" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mi mathvariant="normal">∣</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo>(</mo><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo>)</mo><mi>P</mi><mo>(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo>)</mo></mrow><mrow><mi>P</mi><mo>(</mo><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(model | data) = \frac{P(data | model) P(model)}{P(data)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord">∣</span><span class="mord mathdefault">d</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">a</span><span class="mord mtight">∣</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<ul>
<li data-line="1251" class="code-line">
<p data-line="1251" class="code-line">A model here is a belief network.</p>
<ul>
<li data-line="1252" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(data | model)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord">∣</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span> -&gt; A bigger network can always fit the data better.</li>
<li data-line="1253" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(model)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span> -&gt; allow us to give encoding for a smaller model preference (via description length for example)</li>
</ul>
</li>
<li data-line="1254" class="code-line">
<p data-line="1254" class="code-line">We can search for the best model over the whole network for belief networks (hella meta...)</p>
</li>
<li data-line="1256" class="code-line">
<p data-line="1256" class="code-line">Given total ordering, can do independence test to see what should be parents.</p>
</li>
<li data-line="1257" class="code-line">
<p data-line="1257" class="code-line">XOR problem: just because feature does not give value by itself, combined with other it can provide value</p>
</li>
<li data-line="1258" class="code-line">
<p data-line="1258" class="code-line">search over the totol ordering of variable</p>
</li>
</ul>
<h1 id="l14-planning-under-uncertainty" data-line="1260" class="code-line">L14, Planning Under Uncertainty</h1>
<h2 id="preferences" data-line="1262" class="code-line">Preferences:</h2>
<ul>
<li data-line="1264" class="code-line">
<p data-line="1264" class="code-line">Action result in outcomes, agent would prefer certain outcomes</p>
</li>
<li data-line="1265" class="code-line">
<p data-line="1265" class="code-line">Decision-theoretic rational agent will do action that give the best outcome fro them</p>
<ul>
<li data-line="1267" class="code-line">Sometimes don't know outcome, but will need to compare</li>
</ul>
</li>
</ul>
<p data-line="1269" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/19.png" alt="image" class="loading" id="image-hash-6ab5007ceedc01d2204b665a62dc2881d9aa613297a72d9bb3fc3c95b6885ce1"></p>
<h3 id="lotteries" data-line="1271" class="code-line">Lotteries</h3>
<ul>
<li data-line="1273" class="code-line">Agent may not know the outcome of their actions, but only have a probability distribution over outcomes: outcome <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>o</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">o_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> at probability <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h3 id="properties" data-line="1275" class="code-line">Properties</h3>
<ul>
<li data-line="1277" class="code-line">Completeness: Agents must act, hence they need preferences</li>
<li data-line="1278" class="code-line">Transitivity: if one is better than another, which is better than another, then it carrys forward etc.</li>
<li data-line="1279" class="code-line">Monotonicity: Choose larger chance at getting outcome instead of a smaller chance.</li>
<li data-line="1280" class="code-line">Continuity: at some point in probability, the worse option, being more probable, is preferred
<ul>
<li data-line="1281" class="code-line">A &gt; B &gt; C, at some point p, [p: A, 1-p:C] is indifferent to B.</li>
</ul>
</li>
<li data-line="1282" class="code-line">Decomposability: no fun in gambling, same probabilities and same outcome then the agent should not care.</li>
<li data-line="1283" class="code-line">Substitutability: if a and b are indifferent, then lotteries between them is decomposable (no preferences) too then.</li>
</ul>
<h3 id="theorem" data-line="1285" class="code-line">Theorem</h3>
<ul>
<li data-line="1287" class="code-line">Preference can then be measured by a &quot;utility&quot; function
<ul>
<li data-line="1288" class="code-line">utility: outcomes -&gt; [0,1]</li>
<li data-line="1289" class="code-line">It is linear with probabilities so that you can multiply them together</li>
</ul>
</li>
<li data-line="1290" class="code-line">Utility = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>p</mi><mi>i</mi></msub><mo>×</mo><mi>u</mi><mi>t</mi><mi>i</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo>(</mo><msub><mi>o</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_i p_i \times utility(o_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
<h2 id="rationality-vs-irrationality" data-line="1292" class="code-line">Rationality vs Irrationality</h2>
<ul>
<li data-line="1294" class="code-line">Rational Agents act to maximize expected utility (humans are not the most rational of beings sadly)
<ul>
<li data-line="1295" class="code-line">the max overall utility is the best option!</li>
</ul>
</li>
</ul>
<h3 id="prospect-theory" data-line="1297" class="code-line">Prospect Theory</h3>
<ul>
<li data-line="1299" class="code-line">We such at being rational at looking at gains vs losses</li>
<li data-line="1300" class="code-line">Shown also through Framing Effect</li>
</ul>
<h2 id="making-decisions" data-line="1302" class="code-line">Making Decisions</h2>
<ul>
<li data-line="1304" class="code-line">Agent should make decisions based on
<ul>
<li data-line="1305" class="code-line">ability: what are the options available</li>
<li data-line="1306" class="code-line">beliefs: what is the situation given knowledge of the agent, this updates based on what the agent senses</li>
<li data-line="1307" class="code-line">preferences: what the agent wants</li>
</ul>
</li>
</ul>
<p data-line="1309" class="code-line">Single Decisions</p>
<ul>
<li data-line="1311" class="code-line">Decision variable are like random variable that agent gets to choose value of
<ul>
<li data-line="1312" class="code-line">Expected Utility of decision <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>=</mo><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">D=d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> leads to outcome <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span></eq> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mo>(</mo><mi>u</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>=</mo><msub><mi>d</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><mo>∑</mo><mi>P</mi><mo>(</mo><mi>w</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>=</mo><msub><mi>d</mi><mi>i</mi></msub><mo>)</mo><mi>u</mi><mo>(</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">e(u|D=d_i) = \sum P(w|D=d_i)u(w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">u</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li data-line="1313" class="code-line">Optimal Single Solution: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>=</mo><msub><mi>d</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D=d_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> where expected utility is maximal!
<ul>
<li data-line="1314" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mo>(</mo><mi>u</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>=</mo><msub><mi>d</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mi>P</mi><mo>(</mo><mi>w</mi><mi mathvariant="normal">∣</mi><mi>D</mi><mo>=</mo><msub><mi>d</mi><mi>i</mi></msub><mo>)</mo><mi>u</mi><mo>(</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">e(u|D=d_i) = \max P(w|D=d_i)u(w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">u</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
</ul>
<h2 id="decision-network" data-line="1316" class="code-line">Decision Network</h2>
<p data-line="1318" class="code-line">A Decision Network is a graphical representation of a finite sequential decision problem</p>
<ul>
<li data-line="1320" class="code-line">Extension of belief networks to include decision variables and utility</li>
<li data-line="1321" class="code-line">Specifies what information is available when agent has to act.</li>
</ul>
<h3 id="network-objects" data-line="1323" class="code-line">Network Objects</h3>
<ul>
<li data-line="1325" class="code-line">Circle -&gt; Random Variable, Arcs represent probabilistic dependence</li>
<li data-line="1326" class="code-line">Square -&gt; Decision Variable, Arcs represent information available when decision is made</li>
<li data-line="1327" class="code-line">Diamond -&gt; Utility, Arcs represent variable that utility depends on</li>
</ul>
<h3 id="finding-optimal-decision" data-line="1329" class="code-line">Finding Optimal Decision</h3>
<ul>
<li data-line="1331" class="code-line">Create a Factor for each CPT and Utility</li>
<li data-line="1332" class="code-line">Multiply and Sum Out all random variables</li>
<li data-line="1333" class="code-line">This gives factor on Decision variables D
<ul>
<li data-line="1334" class="code-line">Choose maximum value in Factor!</li>
</ul>
</li>
</ul>
<ul>
<li data-line="1336" class="code-line">For Sequential Decisions: Agent act, observe, act, observer (repeat)
<ul>
<li data-line="1337" class="code-line">subsequent action always based on what was observed (which is caused by previous actions)</li>
</ul>
</li>
</ul>
<h2 id="sequential-decision-problems" data-line="1339" class="code-line">Sequential Decision Problems</h2>
<ul>
<li data-line="1341" class="code-line">Sequence of decision variables</li>
<li data-line="1342" class="code-line">Each <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">D_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> has a information set of variables -&gt; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo>(</mo><msub><mi>D</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">parents(D_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> -&gt; value known at time of decision</li>
<li data-line="1343" class="code-line">Policy specify what agent should do under each circumstance
<ul>
<li data-line="1344" class="code-line">Sequence of decision functions</li>
<li data-line="1345" class="code-line">Observe parent first, then can do child.</li>
</ul>
</li>
</ul>
<h3 id="expected-utility-of-policy" data-line="1347" class="code-line">Expected Utility of Policy</h3>
<ul>
<li data-line="1349" class="code-line">Possible world <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span></eq> satisfy policy means that policy assigns same value as the world</li>
<li data-line="1350" class="code-line">The expected utility is the sum of all worlds that satisfy policy:
<ul>
<li data-line="1351" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∑</mo><mi>u</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo>×</mo><mi>P</mi><mo>(</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum u(w) \times P(w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li data-line="1352" class="code-line">The optimal policy is the highest utility</li>
</ul>
<p data-line="1354" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/20.png" alt="image" class="loading" id="image-hash-1b5c23066cd1c52f1e0e2dc5545ac5eaa340c78378bb7a23106f85a5bf0d8d54"></p>
<p data-line="1356" class="code-line">Example</p>
<p data-line="1358" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/21.png" alt="image" class="loading" id="image-hash-eff77e0a86dfe3daa5dd38a24e25b9e2fca8039024ecd8c5227f825ffebbe7d7"></p>
<h1 id="l15-planning-2" data-line="1360" class="code-line">L15, Planning 2</h1>
<p data-line="1362" class="code-line">Agents carry out actions:</p>
<ul>
<li data-line="1364" class="code-line">forever -&gt; infinite horizons</li>
<li data-line="1365" class="code-line">until some stopping criteria -&gt; indefinite horizon</li>
<li data-line="1366" class="code-line">fixed/finite steps -&gt; finite horizon</li>
</ul>
<p data-line="1368" class="code-line">Decision-theoretic Planning</p>
<ul>
<li data-line="1370" class="code-line">what should agent do when it
<ul>
<li data-line="1371" class="code-line">gets reward/punishment and try to optimize rewards</li>
<li data-line="1372" class="code-line">actions are noisy: outcome of action is of another action</li>
<li data-line="1373" class="code-line">there is another model that specifies prob. outcome of actions</li>
<li data-line="1374" class="code-line">assume world is fully observable</li>
</ul>
</li>
</ul>
<p data-line="1376" class="code-line">World State</p>
<ul>
<li data-line="1378" class="code-line">the information such that if you knew the world state, no info from past is relevant to future
<ul>
<li data-line="1379" class="code-line">Markovian Assumption!</li>
<li data-line="1380" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>S</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>0</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(S_{t+1} | S_0, A_0,..., S_t, A_t) = P(S_{t+1} | S_t, A_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li data-line="1381" class="code-line"><strong>Dynamics is stationary if distribution is the same for each time point!</strong></li>
</ul>
<p data-line="1383" class="code-line">Planning Horizons: how far ahead the planner looks to make decision (infinite, indefinite, finite)</p>
<h2 id="decision-process---markov-decision-process" data-line="1385" class="code-line">Decision Process - Markov Decision Process</h2>
<p data-line="1387" class="code-line">Augmented Markov Chain with actions and values (utility)</p>
<p data-line="1389" class="code-line">Specify</p>
<ul>
<li data-line="1391" class="code-line">Set S of states</li>
<li data-line="1392" class="code-line">Set A of actions</li>
<li data-line="1393" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">P(S_{t+1} | S_t, A_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> is the dynamic</li>
<li data-line="1394" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">R(S_t, A_t, S_{t+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> is the reward. Agent gets reward at each time step, this is the EXPECTED reward</li>
</ul>
<p data-line="1396" class="code-line">Information Availability</p>
<ul>
<li data-line="1398" class="code-line">Fully Observable MDP -&gt; agent gets to observe <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> when deciding on action <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li data-line="1399" class="code-line">Partially Observable MDP -&gt; some noisey sensor of state, needs to remember its sensing and acting history -&gt; maintainig a complex belief state.</li>
</ul>
<p data-line="1401" class="code-line">Rewards and Values</p>
<ul>
<li data-line="1403" class="code-line">When an agent receives a sequence of rewards -&gt; what value should be assigned?
<ul>
<li data-line="1404" class="code-line">Total Rewards</li>
<li data-line="1405" class="code-line">Average Rewards</li>
<li data-line="1406" class="code-line">Discounted Rewards <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mo>=</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><mi>a</mi><msub><mi>r</mi><mn>2</mn></msub><mo>+</mo><msup><mi>a</mi><mn>2</mn></msup><msub><mi>r</mi><mn>3</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mn>0</mn><mo>≤</mo><mi>a</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">V = r_1 + ar_2 + a^2r_3..., 0 \le a \le 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> hence diminishing in value.</li>
</ul>
</li>
</ul>
<p data-line="1408" class="code-line">Policy</p>
<ul>
<li data-line="1410" class="code-line">Stationary Policy: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi><mo>:</mo><mi>S</mi><mo>−</mo><mo>&gt;</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\pi: S-&gt;A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>
<ul>
<li data-line="1411" class="code-line">dictates what the agent should do given state S</li>
<li data-line="1412" class="code-line">Optimal: Discounted Rewards that is Max!</li>
</ul>
</li>
<li data-line="1413" class="code-line">Fully Observable MDP with <strong>stationary dynamics</strong> and rewards, always a optimal stationary policy
<ul>
<li data-line="1414" class="code-line">Later example will show that the distribution does not change!!</li>
</ul>
</li>
</ul>
<p data-line="1416" class="code-line">Value of a Policy</p>
<ul>
<li data-line="1418" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mi>π</mi></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q^\pi(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span> the expected value of doing <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span></eq> in state <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span></eq>, following policy</li>
<li data-line="1419" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mi>π</mi></msup><mo>(</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">V^\pi(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> the expected value of following policy in state <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span></eq>, following policy</li>
<li data-line="1420" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mi>π</mi></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>=</mo><mtext>Sum of future decisions times its reward</mtext></mrow><annotation encoding="application/x-tex">Q^\pi(s,a) = \text{Sum of future decisions times its reward}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">Sum of future decisions times its reward</span></span></span></span></span></li>
<li data-line="1421" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mi>π</mi></msup><mo>(</mo><mi>s</mi><mo>)</mo><mo>=</mo><msup><mi>Q</mi><mi>π</mi></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>π</mi><mo>(</mo><mi>s</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">V^\pi(s) = Q^\pi(s, \pi(s))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p data-line="1423" class="code-line">Value of Optimal Policy</p>
<ul>
<li data-line="1425" class="code-line">Basically, choosing the max and argmax!</li>
</ul>
<p data-line="1427" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/22.png" alt="image" class="loading" id="image-hash-0439dd4d59733726fa028e848472507de6844db4081d7a588e46e859811fba70"></p>
<p data-line="1429" class="code-line">Note in these images: the weird thing is the discount factor!</p>
<h2 id="value-iteration" data-line="1431" class="code-line">Value Iteration</h2>
<ul>
<li data-line="1433" class="code-line">Look ahead value function: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">V^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span> -&gt; expected value with <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span></eq> steps to go</li>
<li data-line="1434" class="code-line">Set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">V^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span> arbitrarily, t=1</li>
<li data-line="1435" class="code-line">Compute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mi>t</mi></msup><mo separator="true">,</mo><msup><mi>V</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">Q^t, V^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9879959999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span> from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">V^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p data-line="1437" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/23.png" alt="image" class="loading" id="image-hash-d7e7761e97cc9cd8c832647afda1acf6fbdd054b326782065560f74d68ab595c"></p>
<p data-line="1439" class="code-line">Note in these images: the weird thing is the discount factor!</p>
<h3 id="example" data-line="1441" class="code-line">Example</h3>
<p data-line="1443" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/24.png" alt="image" class="loading" id="image-hash-7bdc5a39706d3c4c7f8e815face1f2c30f6b32b7ceb1051ae30bf32da6279f48"></p>
<p data-line="1445" class="code-line">After, to do iteration, basically row 1 = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mi>s</mi><mo separator="true">,</mo><mi>A</mi><mo>=</mo><mi>a</mi><mo>)</mo><msup><mi>V</mi><mn>0</mn></msup><mo>(</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">P(s&#x27; |s, A = a)V^0(s&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> and row 2 = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mi>s</mi><mo separator="true">,</mo><mi>A</mi><mo>=</mo><mi>b</mi><mo>)</mo><msup><mi>V</mi><mn>0</mn></msup><mo>(</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">P(s&#x27; |s, A = b)V^0(s&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, then u find the best value of the rows, and decide which decision A is the best for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span></span></span></span></p>
<p data-line="1447" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/25.png" alt="image" class="loading" id="image-hash-0d890bcd6b4d7216e9d640b8fa5c608ffb00e0e68d8c15c940d2cf56e6a53c69"></p>
<p data-line="1449" class="code-line">After this, each iteration, use the previous Max from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>max</mi><mo>⁡</mo><mi>a</mi></msub><mo>(</mo><msup><mi>Q</mi><mi>i</mi></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\max_a(Q^i(s, a))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
<h2 id="asynchronous-value-iteration" data-line="1451" class="code-line">Asynchronous Value Iteration</h2>
<ul>
<li data-line="1453" class="code-line">No need to check all the states, but can update value function for each state individually</li>
<li data-line="1454" class="code-line">You can store either <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mo>[</mo><mi>s</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">V[s]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mopen">[</span><span class="mord mathdefault">s</span><span class="mclose">]</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>[</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">Q[s,a]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">[</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">]</span></span></span></span></li>
<li data-line="1455" class="code-line">Basically loop forever while storing this</li>
</ul>
<h3 id="markov-decision-processes-factored-state" data-line="1457" class="code-line">Markov Decision Processes: Factored State</h3>
<ul>
<li data-line="1459" class="code-line">Not 1 S, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>=</mo><mrow><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mrow><annotation encoding="application/x-tex">S = {X_1, ...}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></span></li>
<li data-line="1460" class="code-line">For each <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, and action A -&gt; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msubsup><mi>X</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><mi mathvariant="normal">∣</mi><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(X_i&#x27;|S, A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.010556em;vertical-align:-0.258664em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mclose">)</span></span></span></span> basically the P function now has a bunch fo sub function</li>
<li data-line="1461" class="code-line">Rewards function gets the same treatment and is additive!</li>
</ul>
<p data-line="1463" class="code-line">For All cases:</p>
<ul>
<li data-line="1465" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msup><mi>S</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mi>S</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(S&#x27;|S,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span> = [num state x num state]</li>
<li data-line="1466" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">R(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> = [num state x 1] -&gt; Reward at each state!</li>
</ul>
<h2 id="pomdps" data-line="1468" class="code-line">POMDPs</h2>
<ul>
<li data-line="1470" class="code-line">Similar to MDP, but some variables are not observed!</li>
</ul>
<p data-line="1472" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/26.png" alt="image" class="loading" id="image-hash-34da473dab2b9079885e096c290bfcf259b38e2e54ead5b323f68cdc3ed838a5"></p>
<p data-line="1474" class="code-line">V(b) can be represented with a piece wise function over the belief space</p>
<h2 id="policies" data-line="1476" class="code-line">Policies</h2>
<ul>
<li data-line="1478" class="code-line">Map beliefs states into actions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi><mo>(</mo><mi>b</mi><mo>(</mo><mi>s</mi><mo>)</mo><mo>)</mo><mo>→</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">\pi(b(s)) \to a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span></li>
<li data-line="1479" class="code-line">2 Ways for compute policy
<ul>
<li data-line="1480" class="code-line">Backwards Search
<ul>
<li data-line="1481" class="code-line">DP (Variable Eliminations)</li>
<li data-line="1482" class="code-line">What we have done above with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{t}(s, a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span>
<ul>
<li data-line="1483" class="code-line">POMDP: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><mi>b</mi><mo>(</mo><mi>s</mi><mo>)</mo><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{t}(b(s), a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span></li>
<li data-line="1484" class="code-line">b is belief states</li>
</ul>
</li>
<li data-line="1485" class="code-line">point based backup make this efficient</li>
</ul>
</li>
<li data-line="1486" class="code-line">Forward Search - Monte Carlo Tree Search
<ul>
<li data-line="1487" class="code-line">Expand the search tree</li>
<li data-line="1488" class="code-line">expand more in promising directions</li>
<li data-line="1489" class="code-line">Ensure exploration using things like UCB</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="monte-carlo-tree-search" data-line="1491" class="code-line">Monte Carlo Tree Search</h2>
<ul>
<li data-line="1493" class="code-line">Selection: select node to visit based on tree policy</li>
<li data-line="1494" class="code-line">Expansion: new node added to tree upon selection</li>
<li data-line="1495" class="code-line">Simulation: Run trial simulation from a default policy from the new node until terminal</li>
<li data-line="1496" class="code-line">Back propagation: sampled statistics from the simulation is given back from child to ancestors</li>
</ul>
<p data-line="1498" class="code-line">I doubt we need to know this shit but here:</p>
<p data-line="1500" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/27.png" alt="image" class="loading" id="image-hash-091e8c7e51ab8c95cb816e5295b28b2329cc0dfb615d35cb7c59e403724da4e2"></p>
<h1 id="l16-planning-under-uncertainty-pt-3" data-line="1502" class="code-line">L16, Planning under uncertainty pt 3</h1>
<h2 id="reinforcement-learning" data-line="1504" class="code-line">Reinforcement Learning</h2>
<ul>
<li data-line="1506" class="code-line">Agent given: prior knowledge, observation (including immediate rewards) and goal</li>
<li data-line="1507" class="code-line">Like the Decision Theoretic Planning, but model of dynamics and model of reward not given!</li>
</ul>
<p data-line="1509" class="code-line">Assume Sequence of experiences: State -&gt; Action -&gt; Reward</p>
<p data-line="1511" class="code-line">Why is Reinforcement Learning Hard?</p>
<ul>
<li data-line="1513" class="code-line">What actions responsible for reward may have been a long time ago</li>
<li data-line="1514" class="code-line">Long Term effect of action depends on what it will do</li>
<li data-line="1515" class="code-line">Explore-Exploit dilemma!
<ul>
<li data-line="1516" class="code-line">Agent decide between explore: more knowledge and exploit: use existing knowledge</li>
</ul>
</li>
</ul>
<p data-line="1518" class="code-line">Main Approaches</p>
<ul>
<li data-line="1520" class="code-line">Search through a space of policies</li>
<li data-line="1521" class="code-line">learn a model consisting of state transition function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mi>a</mi><mo separator="true">,</mo><mi>s</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">P(s&#x27;|a, s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">R(s,a, s&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> -&gt; Solve as MDP</li>
<li data-line="1522" class="code-line">learn <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>Q</mi><mo>∗</mo></msup><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q^*(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span> -&gt; use this to guide action</li>
</ul>
<h3 id="model-based-reinforcement-learning" data-line="1524" class="code-line">Model Based Reinforcement Learning</h3>
<ul>
<li data-line="1526" class="code-line">
<p data-line="1526" class="code-line">Uses the experiences in a more effective manner</p>
</li>
<li data-line="1527" class="code-line">
<p data-line="1527" class="code-line">Used when collecting experiences is expensive and you have a lot of computation between each experience</p>
</li>
<li data-line="1528" class="code-line">
<p data-line="1528" class="code-line">IDEA: learn MDP and interleave acting and planning</p>
<ul>
<li data-line="1530" class="code-line">After each experience, update probabilities and the reward -&gt; do some async value iteration</li>
</ul>
</li>
<li data-line="1532" class="code-line">
<p data-line="1532" class="code-line">Key points: Keep track of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>[</mo><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo>]</mo><mo separator="true">,</mo><mi>T</mi><mo>[</mo><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>S</mi><mo>]</mo><mo separator="true">,</mo><mi>R</mi><mo>[</mo><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">Q[S,A], T[S,A,S], R[S,A]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mclose">]</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>[</mo><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>S</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">T[S,A,S]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">]</span></span></span></span> is just prior counts.</p>
</li>
</ul>
<p data-line="1534" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/28.png" alt="image" class="loading" id="image-hash-784f2f298aa1811080e66e6026fa0a079d77de82597c27f08908e51e75637e4b"></p>
<p data-line="1536" class="code-line">Note: The reward function is based from some temporal differences calculation</p>
<ul>
<li data-line="1538" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><msub><mi>A</mi><mi>k</mi></msub><mo>=</mo><mo>(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>A</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">kA_k = (k-1)*A_{k-1} + v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li data-line="1539" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><msub><mi>A</mi><mi>k</mi></msub><mo>=</mo><mo>(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo>)</mo><mo>∗</mo><msub><mi>A</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">kA_k = (k-1)*A_{k-1} + v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li data-line="1540" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">\alpha = 1/k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> then this becomes TD formula as each new value arrives:</li>
<li data-line="1541" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>k</mi></msub><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo>)</mo><mo>∗</mo><msub><mi>A</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>α</mi><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">A_k = (1-\alpha)*A_{k-1} + \alpha v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h2 id="q-learning" data-line="1543" class="code-line">Q-learning</h2>
<ul>
<li data-line="1545" class="code-line">Idea: Store Q[S,A] and update this like in Async Value Iteration
<ul>
<li data-line="1546" class="code-line">Use best experience instead of CPT (empirical prob instead)</li>
</ul>
</li>
<li data-line="1547" class="code-line">Experience: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&lt;</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;s, a, r, s&#x27;&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span></span></span>
<ul>
<li data-line="1548" class="code-line">provided to update Q[s,a]</li>
<li data-line="1549" class="code-line">experience provides data point: (assuming <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">ρ</span></span></span></span> is discount factor)
<ul>
<li data-line="1550" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>+</mo><mi>ρ</mi><msub><mi>max</mi><mo>⁡</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup></msub><mi>Q</mi><mo>[</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mo>]</mo></mrow><annotation encoding="application/x-tex">r+\rho\max_{a&#x27;}Q[s&#x27;,a&#x27;]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32797999999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Q</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></li>
<li data-line="1551" class="code-line">Apply this to the TD formula</li>
<li data-line="1552" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>[</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>]</mo><mo>=</mo><mi>Q</mi><mo>[</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>]</mo><mo>+</mo><mi>α</mi><mo>(</mo><mi>r</mi><mo>+</mo><mi>ρ</mi><msub><mi>max</mi><mo>⁡</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup></msub><mi>Q</mi><mo>[</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mo>]</mo><mo>−</mo><mi>Q</mi><mo>[</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">Q[s,a] = Q[s,a] + \alpha(r+\rho\max_{a&#x27;}Q[s&#x27;,a&#x27;]-Q[s,a])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">[</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">[</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32797999999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Q</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">[</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
</ul>
</li>
</ul>
<p data-line="1554" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/29.png" alt="image" class="loading" id="image-hash-4302be451cf449c08daf82a82d82b18d9165af7c235f52fc797323c1fe9898b5"></p>
<p data-line="1556" class="code-line">Convergence and Termination</p>
<ul>
<li data-line="1558" class="code-line">N(s,a): number: number of time action a taken in state s
<ul>
<li data-line="1559" class="code-line">make this the learning rate: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span></span></span></span></li>
</ul>
</li>
<li data-line="1560" class="code-line">Q-learning converges if every state-action visited infinite times.
<ul>
<li data-line="1561" class="code-line">set convergence to be when average over last N steps is below <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></li>
</ul>
</li>
<li data-line="1562" class="code-line">Q-learning converges to optimal if each state/action tried enough
<ul>
<li data-line="1563" class="code-line">But what should it do? exploit vs explore?</li>
</ul>
</li>
</ul>
<p data-line="1565" class="code-line">Exploration Strategies</p>
<ul>
<li data-line="1567" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span>-greedy strategy: choose a random action with probability <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span> and best action with choose a random action with probability <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>−</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">1- \epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></li>
<li data-line="1568" class="code-line">Softmax action selection:</li>
</ul>
<p data-line="1570" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/30.png" alt="image" class="loading" id="image-hash-65c366e950256e353fd75176f8af4183d999de310a736badb18f88dae84f424b"></p>
<ul>
<li data-line="1572" class="code-line">&quot;optimisim in face of uncertainty&quot; -&gt; initialize Q to values that encourages exploration</li>
<li data-line="1573" class="code-line">Upper Confidence Bound (UCB) -&gt; Also store N[s,a] to keep track number of times s, a chosen</li>
<li data-line="1574" class="code-line"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mtext>argmax</mtext><mi>a</mi></msub><mo>[</mo><mi>Q</mi><mo>[</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>]</mo><mo>+</mo><mi>k</mi><msqrt><mfrac><mrow><mi>N</mi><mo>[</mo><mi>s</mi><mo>]</mo></mrow><mrow><mi>N</mi><mo>[</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo>]</mo></mrow></mfrac></msqrt><mo>]</mo></mrow><annotation encoding="application/x-tex">\text{argmax}_a[Q[s,a]+k\sqrt{\frac{N[s]}{N[s,a]}}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">argmax</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault">Q</span><span class="mopen">[</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.6100000000000001em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.23em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mopen mtight">[</span><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mopen mtight">[</span><span class="mord mathdefault mtight">s</span><span class="mclose mtight">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.1899999999999995em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em' height='1.8800000000000001em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,
572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,
-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39
c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60
s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,
-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10z
M1001 80H400000v40H1013z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6100000000000001em;"><span></span></span></span></span></span><span class="mclose">]</span></span></span></span></li>
</ul>
<p data-line="1576" class="code-line">Back to the example</p>
<ul>
<li data-line="1578" class="code-line">Off/On Policy Learning
<ul>
<li data-line="1579" class="code-line">Q-learning does off-policy learning: learns value of the optimal policy regardless of what it does
<ul>
<li data-line="1580" class="code-line">bad if exploration should NOT be done</li>
</ul>
</li>
<li data-line="1581" class="code-line">On-policy: learns the value of the policy being followed -&gt; if current policy is to explore, it can optimize what it should do
<ul>
<li data-line="1582" class="code-line">SARSA uses <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&lt;</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal">′</mo></msup><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt; s, a, r, s&#x27;, a&#x27; &gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span></span></span> to update Q[s,a]</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="sarsa" data-line="1584" class="code-line">SARSA</h2>
<p data-line="1586" class="code-line">Doubt we need to know this...</p>
<p data-line="1588" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/31.png" alt="image" class="loading" id="image-hash-a4c9ac4f6f54c70ce02efd623511380a533aaaa62df85758e1a041d96e51d54e"></p>
<p data-line="1590" class="code-line">##Q-function Approximation</p>
<ul>
<li data-line="1592" class="code-line">Difficult for large state spaces</li>
<li data-line="1593" class="code-line">Linear vs non-linear
<ul>
<li data-line="1594" class="code-line">Linear still converges</li>
<li data-line="1595" class="code-line">Non-linear may diverge... to mitigate:
<ul>
<li data-line="1596" class="code-line">Experience Replay
<ul>
<li data-line="1597" class="code-line">Sample a batch of previous experiences at each step to learn
<ul>
<li data-line="1598" class="code-line">breaks correlation between successive updates</li>
</ul>
</li>
</ul>
</li>
<li data-line="1599" class="code-line">Use 2 Q function
<ul>
<li data-line="1600" class="code-line">Q network: currently used and updated</li>
<li data-line="1601" class="code-line">Target network: occasionally updated
<ul>
<li data-line="1602" class="code-line">Update using mini-batch</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="bayesian-reinforcement-learning" data-line="1604" class="code-line">Bayesian Reinforcement Learning</h2>
<ul>
<li data-line="1606" class="code-line">Include Transition Function and Observation Function in state space
<ul>
<li data-line="1607" class="code-line">Learning through inference (belief space)</li>
<li data-line="1608" class="code-line"></li>
</ul>
</li>
</ul>
<h2 id="l17-affective-dynamics-and-control" data-line="1610" class="code-line">L17, Affective Dynamics and Control</h2>
<ul>
<li data-line="1612" class="code-line">AI Lacks empathy, altruism, culture and emotion (which is now needed for intelligence)</li>
</ul>
<p data-line="1614" class="code-line">Low Road vs High Road: Thinking fast and slow.</p>
<ul>
<li data-line="1616" class="code-line">System 1: Fast: operates fast and quickly</li>
<li data-line="1617" class="code-line">System 2: Slow: more mental activity (System 1 calls on this when in trouble)</li>
</ul>
<p data-line="1619" class="code-line">Affective Computing: cognitive machine disrupted by emotion (perception -&gt; cognition (emotion) -&gt; action)</p>
<h2 id="affect-control-theory" data-line="1621" class="code-line">Affect Control Theory:</h2>
<ul>
<li data-line="1623" class="code-line">
<p data-line="1623" class="code-line">emotional machine disrupted by cognition (perception -&gt; affect (cognition) -&gt; action)</p>
</li>
<li data-line="1624" class="code-line">
<p data-line="1624" class="code-line">People try to experience events that confirm fundamental sentiments</p>
<ul>
<li data-line="1626" class="code-line">Shared sentiments, emotional dynamics and consistency-&gt;cooperation</li>
</ul>
</li>
</ul>
<p data-line="1628" class="code-line"><img style="max-width:400px;" src="/Users/davidliu/Documents/Year%204/Year5Notes/CS486AI/images/32.png" alt="image" class="loading" id="image-hash-ea081e2268011e5b67ace8ae481cf35ab1d062a4ed6e81efcafa9889684afc0a"></p>
<ul>
<li data-line="1630" class="code-line">Actor - Behavior - Object</li>
<li data-line="1631" class="code-line">Affect Control Principle: Actors work to experience transient impressions that are consistent with their fundamental sentiments</li>
<li data-line="1632" class="code-line">Calculate Deflection from the Object as feedback</li>
</ul>
<p data-line="1634" class="code-line">Bayesian Affect Control Theory - Model Uncertainty</p>

</body></html>